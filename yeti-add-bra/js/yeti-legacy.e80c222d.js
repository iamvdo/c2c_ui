(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["yeti"],{"03a8":function(t,e,a){},"0489":function(t,e,a){"use strict";a("7704")},"0c6e":function(t,e,a){t.exports=a.p+"img/logo-ensg.12db1227.avif"},"11ed":function(t,e,a){},1287:function(t,e,a){"use strict";a("6cbe")},"12da":function(t,e,a){},1993:function(t,e,a){"use strict";a("da3b")},"27b2":function(t,e,a){},"2bd6":function(t,e,a){},"2d99":function(t,e,a){"use strict";a("5a2e")},"301b":function(t,e,a){"use strict";a("2bd6")},"377f":function(t,e,a){"use strict";a("3a5e")},"3a5e":function(t,e,a){},"3d7f":function(t,e,a){t.exports=a.p+"img/logo-fondation-petzl.1d7d0bdd.avif"},"5a2e":function(t,e,a){},"60a4":function(t,e,a){t.exports=a.p+"img/levels-danger.ab1771e4.svg"},"6cbe":function(t,e,a){},"764b":function(t,e,a){"use strict";a("a831")},7704:function(t,e,a){},8309:function(t,e,a){"use strict";a("12da")},"84a2":function(t,e,a){"use strict";a("af24")},8714:function(t,e,a){"use strict";a("27b2")},9209:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"section"},[a("html-header",{attrs:{title:"Yeti"}}),t._v(" "),a("div",{staticClass:"box"},[a("h1",{staticClass:"title is-1"},[a("div",{staticClass:"yeti-icon is-inline-block"},[a("icon-yeti")],1),t._v(" "),a("span",{directives:[{name:"translate",rawName:"v-translate"}]},[t._v("YETI - A preparation tool for your outing")])])]),t._v(" "),a("div",{staticClass:"yeti-app"},[t.showDisclaimer?a("div",{staticClass:"box yeti-overlay"},[a("yeti-article",{staticClass:"yeti-article--disclaimer",attrs:{article:t.articles.disclaimer}}),t._v(" "),a("form",{attrs:{action:"#"},on:{submit:t.onSubmitDisclaimer}},[a("input-checkbox",{directives:[{name:"translate",rawName:"v-translate"}],model:{value:t.checkDisclaimer,callback:function(e){t.checkDisclaimer=e},expression:"checkDisclaimer"}},[t._v("\n          I read and understood the interest and limitations of YETI\n        ")]),t._v(" "),a("button",{directives:[{name:"translate",rawName:"v-translate"}],staticClass:"button is-primary",attrs:{disabled:!t.checkDisclaimer}},[t._v("Launch YETI")])],1)],1):t._e(),t._v(" "),"faq"===t.$route.params.page?a("div",{staticClass:"box yeti-overlay"},[a("p",[a("router-link",{directives:[{name:"translate",rawName:"v-translate"}],attrs:{to:"."}},[t._v("Go back to YETI")])],1),t._v(" "),a("yeti-article",{staticClass:"yeti-article--disclaimer",attrs:{article:t.articles.disclaimer}}),t._v(" "),a("yeti-article",{attrs:{article:t.articles.faq}})],1):t._e(),t._v(" "),a("div",{staticClass:"columns yeti-content"},[a("div",{staticClass:"column is-6-tablet is-6-desktop is-5-widescreen is-4-fullhd form-container"},[a("div",{staticClass:"columns mb-0 yeti-columns--reverse is-mobile"},[a("ul",{staticClass:"column is-narrow pb-0"},[a("li",[a("router-link",{directives:[{name:"translate",rawName:"v-translate"}],staticClass:"is-block yetitabs-link",attrs:{to:t.$route.fullPath+"/faq"}},[t._v("\n                FAQ?\n              ")])],1)]),t._v(" "),a("tabs",{attrs:{tabs:t.tabs}})],1),t._v(" "),a("div",{staticClass:"box"},[a("panel",{ref:"panel0",staticClass:"is-relative",attrs:{index:0}},[a("validation-button",{staticClass:"is-hidden-mobile yeti-validation--top",attrs:{"current-error":t.currentError,loading:t.promise,tabindex:"-1"},on:{click:t.compute}}),t._v(" "),a("sub-panel-bra"),t._v(" "),a("sub-panel-methods",{on:{"warn-about-method-bra":t.warnAboutMethodBra}}),t._v(" "),a("validation-button",{directives:[{name:"show",rawName:"v-show",value:t.method.type,expression:"method.type"}],staticClass:"yeti-validation--bottom",attrs:{"current-error":t.currentError,loading:t.promise},on:{click:t.compute}})],1),t._v(" "),a("panel",{ref:"panel1",attrs:{index:1}},[a("sub-panel-course")],1)],1),t._v(" "),t._m(0)]),t._v(" "),a("yeti-map",{ref:"map",attrs:{"yeti-data":t.yetiData,"yeti-extent":t.yetiExtent}})],1)])],1)},i=[function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"box yeti-logos"},[r("div",{staticClass:"columns is-mobile is-vcentered"},[r("div",{staticClass:"column has-text-centered"},[r("a",{attrs:{href:"http://www.ensg.eu"}},[r("picture",[r("source",{attrs:{srcset:a("e004"),type:"image/webp"}}),t._v(" "),r("source",{attrs:{srcset:a("0c6e"),type:"image/avif"}}),t._v(" "),r("img",{attrs:{src:a("aa66"),alt:"Logo ENSG",width:"120",loading:"lazy"}})])])]),t._v(" "),r("div",{staticClass:"column has-text-centered"},[r("a",{attrs:{href:"https://www.petzl.com/fondation/fondation-petzl?language=fr"}},[r("picture",[r("source",{attrs:{srcset:a("d315"),type:"image/webp"}}),t._v(" "),r("source",{attrs:{srcset:a("3d7f"),type:"image/avif"}}),t._v(" "),r("img",{attrs:{src:a("fc52"),alt:"Logo Fondation Petzl",width:"90",loading:"lazy"}})])])])])])}],n=a("bc3a"),s=a.n(n),o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.document?a("div",{staticClass:"yeti-article"},[a("sub-panel-title",[t._v(t._s(t.title))]),t._v(" "),a("markdown-section",{attrs:{document:t.document,field:t.fields.description,"hide-title":""}})],1):t._e()},l=[],u=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"columns is-mobile"},[a("div",{staticClass:"column"},[a("h2",{staticClass:"title is-3"},[t._t("default")],2)])])},h=[],c=(a("e375"),a("2877")),v={},d=Object(c["a"])(v,u,h,!1,null,"43c30758",null),m=d.exports,p=a("188b"),f=a("25c4"),g=a("7306"),y={components:{SubPanelTitle:m,MarkdownSection:g["a"]},props:{article:{type:Object,required:!0}},data(){return{promise:null}},computed:{id(){return this.article.id},title(){return this.article.title},document(){var t,e;return null!==(t=null===(e=this.promise)||void 0===e?void 0:e.data)&&void 0!==t?t:null},fields(){return f["a"].objectDefinitions.article.fields},lang(){return this.$language.current}},watch:{lang(){this.cookDocument()}},mounted(){this.cookDocument()},methods:{cookDocument(){p["a"].article.getCooked(this.id,this.$language.current).then(t=>{this.promise=t})}}},w=y,_=(a("e469"),Object(c["a"])(w,o,l,!1,null,"62129744",null)),b=_.exports,x=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"yeti-panel",attrs:{role:"tabpanel",id:"panel"+t.index,"aria-labelledby":"tab"+t.index,hidden:t.activeTab!==t.index}},[t._t("default")],2)},E=[],S=a("2b0e");let k={API_URL:"https://api.ensg.eu/",DANGER_MAX_WHEN_MRD:3,VALID_MINIMUM_MAP_ZOOM:13,activeTab:0,bra:{high:null,low:null,altiThreshold:null,isDifferent:!1},method:{type:null,orientation:[],potentialDanger:null,wetSnow:!1,groupSize:1},areas:[],areaOk:!0,features:[],featuresTitle:"New route",mountains:{all:[],visible:[]},bulletinsLoaded:!1,showAvalancheBulletins:!1,mapZoom:0};var C,M,L=new S["default"]({data(){return JSON.parse(JSON.stringify(k))},computed:{hasFeatures(){return!!this.features.length}},methods:{setActiveTab(t){this.activeTab=t},setBra(t,e){this.bra[t]=e},setMethod(t,e){this.method[t]=e},setAreas(t){this.areas=t},setAreaOk(t){this.areaOk=t},setFeatures(t){this.features=t},setFeaturesTitle(t){this.featuresTitle=t},setAllMountains(t){this.mountains.all=t},setVisibleMountains(t){this.mountains.visible=t},setShowAvalancheBulletins(t){this.showAvalancheBulletins=t},setBulletinsLoaded(t){this.bulletinsLoaded=t},setMapZoom(t){this.mapZoom=t},setDefault(){for(let t in this.$data)if("object"!==typeof this.$data[t]||Array.isArray(this.$data[t]))this.$data[t]=k[t];else for(let e in this.$data[t])this.$data[t][e]=k[t][e]},fetchApi(t){return s.a.get(this.API_URL+t)},fetchAreas(){return this.fetchApi("yeti-extent")},fetchMountains(){return this.fetchApi("zonesbra")},fetchBulletins(){return this.fetchApi("bra")}}}),N=L,P=Object(c["a"])(N,C,M,!1,null,null,null),F=P.exports,D={props:{index:{type:Number,required:!0}},computed:{activeTab(){return F.activeTab}}},I=D,O=(a("b600"),Object(c["a"])(I,x,E,!1,null,"09d0fe2d",null)),$=O.exports,A=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"yeti-subpanel"},[a("sub-panel-title",[a("span",{directives:[{name:"translate",rawName:"v-translate"}]},[t._v("Danger level")])]),t._v(" "),a("div",{staticClass:"columns is-mobile"},[a("div",{staticClass:"column"},[a("div",{staticClass:"inputs-bra",class:{"inputs-bra-different":t.bra.isDifferent}},[a("svg",{attrs:{viewBox:"0 0 100 100",width:"120",height:"120"}},[a("polygon",{staticStyle:{fill:"none",stroke:"#000","stroke-miterlimit":"10"},attrs:{points:"2.2,89.5 97.5,89.5 62.7,11.9 48,32.9 31.8,25.5 "}}),t._v(" "),a("line",{directives:[{name:"show",rawName:"v-show",value:t.bra.isDifferent,expression:"bra.isDifferent"}],staticStyle:{fill:"none",stroke:"#000","stroke-miterlimit":"10"},attrs:{x1:"10",y1:"61.5",x2:"90",y2:"61.5"}})]),t._v(" "),a("div",{staticClass:"input-bra-high select is-small"},[a("select",{attrs:{id:"selectBra","aria-label":t.$gettext("High danger level from the avalanche bulletin")},domProps:{value:t.bra.high},on:{change:function(e){return t.onChange(e,"high")}}},[a("option",{attrs:{selected:""},domProps:{value:null}}),t._v(" "),a("option",{domProps:{value:1}},[t._v("1")]),t._v(" "),a("option",{domProps:{value:2}},[t._v("2")]),t._v(" "),a("option",{domProps:{value:3}},[t._v("3")]),t._v(" "),a("option",{domProps:{value:4}},[t._v("4")])])]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.bra.isDifferent,expression:"bra.isDifferent"}],staticClass:"input-bra-threshold control"},[a("label",{directives:[{name:"translate",rawName:"v-translate"}],attrs:{for:"inputThreshold"}},[t._v("Altitude")]),t._v(" "),a("input",{staticClass:"input is-small",attrs:{id:"inputThreshold",type:"number",min:"0",max:"4800",step:"100",maxlength:"4"},domProps:{value:t.bra.altiThreshold},on:{change:function(e){return t.onChange(e,"altiThreshold")}}})]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.bra.isDifferent,expression:"bra.isDifferent"}],staticClass:"input-bra-low select is-small"},[a("select",{attrs:{"aria-label":"$gettext('Low danger level from the avalanche bulletin')"},domProps:{value:t.bra.low},on:{change:function(e){return t.onChange(e,"low")}}},[a("option",{attrs:{selected:""},domProps:{value:null}}),t._v(" "),a("option",{domProps:{value:1}},[t._v("1")]),t._v(" "),a("option",{domProps:{value:2}},[t._v("2")]),t._v(" "),a("option",{domProps:{value:3}},[t._v("3")]),t._v(" "),a("option",{domProps:{value:4}},[t._v("4")])])])]),t._v(" "),a("div",[a("input-checkbox",{staticClass:"control--bradifferent",attrs:{value:t.bra.isDifferent},on:{input:function(e){return t.onChange(e,"isDifferent")}}},[a("span",{directives:[{name:"translate",rawName:"v-translate"}]},[t._v("Different high/low danger?")])])],1)])]),t._v(" "),a("div",{staticClass:"yetimountains"},[a("div",[a("p",{staticClass:"yetimountains-title",on:{click:function(e){t.showMountainsList=!t.showMountainsList}}},[a("span",{directives:[{name:"translate",rawName:"v-translate"}]},[t._v("Avalanche bulletins")]),t._v(" "),t.showVisibleMountains?a("counter",[t._v(t._s(t.countVisibleMountains))]):t._e(),t._v(" "),t.showAvalancheBulletins?a("fa-icon",{staticClass:"has-text-primary",attrs:{icon:"check-circle",title:t.$gettext("Visible on map")}}):t._e(),t._v(" "),a("fa-icon",{staticClass:"yetimountains-arrow is-size-6 is-pulled-right has-cursor-pointer no-print",attrs:{icon:"angle-down",rotation:t.showMountainsList?180:void 0}})],1)]),t._v(" "),t.showMountainsList?a("div",[t.showVisibleMountains?a("div",[a("div",{staticClass:"pl-3 mt-2 mb-2"},[a("input-checkbox",{attrs:{value:t.showAvalancheBulletins},on:{input:t.onShowAvalancheBulletins}},[a("span",{directives:[{name:"translate",rawName:"v-translate"}]},[t._v("Visible on map")])])],1),t._v(" "),a("dl",t._l(t.visibleMountains,(function(e,r){return a("div",{key:r},[a("dt",{staticClass:"yetimountains-listtitle"},[t._v("\n              "+t._s(r)+"\n            ")]),t._v(" "),a("div",{staticClass:"yetimountains-list"},t._l(e,(function(e){return a("dd",{key:e.name,staticClass:"yetimountains-listelement"},[a("a",{attrs:{href:e.urls[0].url,target:"_blank"}},[a("fa-icon",{attrs:{icon:"external-link-alt"}}),t._v("\n                  "+t._s(e.name)+"\n                ")],1)])})),0)])})),0)]):a("div",[a("p",{directives:[{name:"translate",rawName:"v-translate"}],staticClass:"column yetiform-info"},[t._v("Massifs could not be loaded")])])]):t._e()])],1)},R=[],T=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",{staticClass:"yeti-counter",class:{"has-background-primary":t.isPrimary}},[t._t("default")],2)},B=[],z={props:{isPrimary:{type:Boolean,default:!1}}},G=z,j=(a("8309"),Object(c["a"])(G,T,B,!1,null,"79e0b738",null)),V=j.exports,Z={components:{Counter:V,SubPanelTitle:m},data(){return{showMountainsList:!1}},computed:{bra(){return F.bra},visibleMountains(){return F.mountains.visible},showAvalancheBulletins(){return F.showAvalancheBulletins},showVisibleMountains(){return this.countVisibleMountains>=0},countVisibleMountains(){return this.visibleMountains?Object.values(this.visibleMountains).reduce((t,e)=>t+e.length,0):-1}},watch:{"bra.isDifferent":"checkBraIsDifferent"},methods:{onChange(t,e){const a="isDifferent"===e?t:t.target.value;F.setBra(e,a)},checkBraIsDifferent(){this.bra.isDifferent||(F.setBra("low",null),F.setBra("altiThreshold",null))},onShowAvalancheBulletins(t){F.setShowAvalancheBulletins(t)}}},q=Z,U=(a("764b"),Object(c["a"])(q,A,R,!1,null,"5542c3be",null)),Y=U.exports,W=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"yeti-subpanel"},[a("sub-panel-title",[a("span",{directives:[{name:"translate",rawName:"v-translate"}]},[t._v("Route")])]),t._v(" "),t.features.length?a("div",[a("div",{staticClass:"columns is-mobile"},[a("div",{staticClass:"column"},[a("p",{staticClass:"features-title"},[a("icon-route",{staticClass:"icon document-icon"}),t._v(" "),a("fa-icon",{staticClass:"icon edit-icon",attrs:{icon:"pen"}}),t._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:!t.hasFeaturesTitle,expression:"!hasFeaturesTitle"},{name:"translate",rawName:"v-translate"}],staticClass:"features-title-text features-title-placeholder",on:{click:t.onEditNewFeaturesTitle}},[t._v("\n            Add title…\n          ")]),t._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:t.hasFeaturesTitle,expression:"hasFeaturesTitle"}],ref:"featuresTitle",staticClass:"features-title-text features-title-content",attrs:{tabindex:"0",contenteditable:"",spellcheck:"false"},on:{blur:t.onEditFeaturesTitle,keypress:function(t){if(!t.type.indexOf("key")&&13!==t.keyCode)return null;t.preventDefault()}}},[t._v(t._s(t.featuresTitle))])],1)]),t._v(" "),a("div",{staticClass:"column is-narrow"},[a("button",{staticClass:"button is-secondary is-small",on:{click:t.onRemoveFeatures}},[a("fa-icon",{staticClass:"trash-icon",attrs:{icon:"trash"}}),t._v(" "),a("span",{directives:[{name:"translate",rawName:"v-translate"}]},[t._v("Delete route")])],1)])]),t._v(" "),a("div",{staticClass:"ml-5 mb-5"},[a("p",{directives:[{name:"translate",rawName:"v-translate"}],staticClass:"yetiform-info is-italic is-marginless"},[t._v("Lines chunks")]),t._v(" "),a("features-list",{attrs:{features:t.features}})],1),t._v(" "),a("sub-panel-title",[a("span",{directives:[{name:"translate",rawName:"v-translate"}]},[t._v("Export")])]),t._v(" "),a("div",{staticClass:"columns is-vcentered is-mobile"},[a("div",{staticClass:"column"},[a("ul",{staticClass:"form-export"},t._l(t.formats,(function(e){return a("li",{key:e,staticClass:"control is-flex"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.format,expression:"format"}],staticClass:"is-checkradio is-primary",attrs:{id:"format"+e,type:"radio",name:"exportFormat"},domProps:{value:e,checked:t._q(t.format,e)},on:{change:function(a){t.format=e}}}),t._v(" "),a("label",{attrs:{for:"format"+e}},[t._v(t._s(e))])])})),0)]),t._v(" "),a("div",{staticClass:"column is-narrow"},[a("button",{directives:[{name:"translate",rawName:"v-translate"}],staticClass:"button is-primary",on:{click:t.downloadCourse}},[t._v("Export route")])])]),t._v(" "),a("div",{staticClass:"yetiform-note mt-5"},[a("p",{directives:[{name:"translate",rawName:"v-translate"}]},[t._v("Drawing tips")]),t._v(" "),a("ul",{staticClass:"content-ul"},[a("li",[a("strong",{directives:[{name:"translate",rawName:"v-translate"}],attrs:{"translate-context":"yeti"}},[t._v("Draw")]),t._v(" "),a("span",{directives:[{name:"translate",rawName:"v-translate"}]},[t._v("new lines chunks")])]),t._v(" "),a("li",[a("strong",{directives:[{name:"translate",rawName:"v-translate"}],attrs:{"translate-context":"yeti"}},[t._v("Delete")]),t._v(" "),a("span",{directives:[{name:"translate",rawName:"v-translate"}]},[t._v("last point with the Backspace key")])])]),t._v(" "),a("p",{directives:[{name:"translate",rawName:"v-translate"}]},[t._v("On a drawn line")]),t._v(" "),a("ul",{staticClass:"content-ul"},[a("li",[a("strong",{directives:[{name:"translate",rawName:"v-translate"}],attrs:{"translate-context":"yeti"}},[t._v("Edit")]),t._v(" "),a("span",{directives:[{name:"translate",rawName:"v-translate"}]},[t._v("points by moving them")])]),t._v(" "),a("li",[a("strong",{directives:[{name:"translate",rawName:"v-translate"}],attrs:{"translate-context":"yeti"}},[t._v("Create")]),t._v(" "),a("span",{directives:[{name:"translate",rawName:"v-translate"}]},[t._v("a new point on an existing line")])]),t._v(" "),a("li",[a("strong",{directives:[{name:"translate",rawName:"v-translate"}]},[t._v("Delete a point")]),t._v(" "),a("span",{directives:[{name:"translate",rawName:"v-translate"}]},[t._v("with Alt + clic")])])]),t._v(" "),a("p",{directives:[{name:"translate",rawName:"v-translate"}]},[t._v("From the interface")]),t._v(" "),a("ul",{staticClass:"content-ul"},[a("li",[a("strong",{directives:[{name:"translate",rawName:"v-translate"}]},[t._v("Delete a line chunk")])]),t._v(" "),a("li",[a("strong",{directives:[{name:"translate",rawName:"v-translate"}]},[t._v("Delete route")]),t._v(" "),a("span",{directives:[{name:"translate",rawName:"v-translate"}]},[t._v("to start or load a new one")])])])])],1):a("div",[a("p",{directives:[{name:"translate",rawName:"v-translate"}]},[t._v("No route right now")]),t._v(" "),a("div",{staticClass:"load-gpx"},[a("button",{directives:[{name:"translate",rawName:"v-translate"}],staticClass:"button is-primary",class:{"is-loading":t.loading},attrs:{disabled:t.loading},on:{click:t.onLoadGpx}},[t._v("\n        Upload a GPS track\n      ")]),t._v(" "),a("div",{staticClass:"control upload-button"},[a("input",{ref:"gpxFileInput",attrs:{type:"file",accept:".gpx"},on:{change:t.uploadGpx}})]),t._v(" "),a("div",{staticClass:"yetiform-note mt-5"},[a("p",[a("strong",{directives:[{name:"translate",rawName:"v-translate"}]},[t._v("Draw right on the map")]),t._v(" "),a("span",{directives:[{name:"translate",rawName:"v-translate"}]},[t._v("to start a new route")])])])])])],1)},K=[],J=a("b166"),X=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ul",{staticClass:"featureslist"},t._l(t.features,(function(e,r){return a("li",{key:r,staticClass:"featureslist-item tag",on:{mouseenter:function(a){return t.showFeature(e)},mouseleave:function(a){return t.hideFeature(e)}}},[a("span",[t._v(t._s(t.nbPointsOnFeature(e))+" points")]),t._v(" "),a("button",{staticClass:"delete is-small",on:{click:function(a){return t.removeFeature(e)}}},[t._v("x")])])})),0)},H=[],Q={props:{features:{type:Array,required:!0}},methods:{removeFeature(t){F.$emit("removeFeature",t)},showFeature(t){t.setStyle(t.get("highlightedStyle"))},hideFeature(t){t.setStyle(t.get("normalStyle"))},nbPointsOnFeature(t){return t.getGeometry().getCoordinates().length}}},tt=Q,et=(a("9d66"),Object(c["a"])(tt,X,H,!1,null,"77f7ceed",null)),at=et.exports,rt=a("dac7"),it=a("9944"),nt={components:{FeaturesList:at,SubPanelTitle:m},data(){return{newFeaturesTitle:!1,loading:!1,formats:["GPX","KML"],format:"GPX"}},computed:{features(){return F.features},featuresTitle(){return F.featuresTitle},hasFeaturesTitle(){return!(!this.featuresTitle.length&&!this.newFeaturesTitle)}},methods:{onEditFeaturesTitle(t){t.target.innerText.length||(this.newFeaturesTitle=!1),F.setFeaturesTitle(t.target.innerText)},onEditNewFeaturesTitle(){this.newFeaturesTitle=!0,this.$nextTick(()=>{this.$refs.featuresTitle.focus()})},onLoadGpx(){this.$refs.gpxFileInput.click()},onRemoveFeatures(){confirm(this.$gettext("Confirm delete"))&&F.$emit("removeFeatures")},uploadGpx(t){this.loading=!0;const e=new FileReader;e.onload=()=>{this.loading=!1,F.$emit("gpx",e.result)},e.readAsText(t.target.files[0]),this.$refs.gpxFileInput.value="",F.$emit("gpx",null)},downloadCourse(){"GPX"===this.format?this.downloadFeatures(new rt["a"].format.GPX,".gpx","application/gpx+xml"):"KML"===this.format&&this.downloadFeatures(new rt["a"].format.KML,".kml","application/vnd.google-earth.kml+xml")},downloadFeatures(t,e,a){const r=this.features;r[0].set("name",this.featuresTitle);const i=this.setFilename(e),n=t.writeFeatures(r,{featureProjection:"EPSG:3857"});it["a"].download(n,i,a+";charset=utf-8")},setFilename(t){return Object(J["a"])(new Date,"yyyy-MM-dd_HH-mm-ss")+t}}},st=nt,ot=(a("84a2"),Object(c["a"])(st,W,K,!1,null,"69a4d21b",null)),lt=ot.exports,ut=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"yeti-subpanel"},[a("sub-panel-title",[a("span",{directives:[{name:"translate",rawName:"v-translate"}]},[t._v("Methods")])]),t._v(" "),a("div",{staticClass:"columns is-mobile yetitabs"},t._l(Object.keys(t.methods),(function(e){return a("div",{key:e,staticClass:"column yetitab"},[a("div",{staticClass:"control yetitab-control",class:{"yetitab-control--selected":t.method.type===e}},[a("input",{staticClass:"is-checkradio is-primary",attrs:{id:"c2c-method-"+e,type:"radio",name:"method",disabled:"mrd"===e&&(4==t.bra.high||4==t.bra.low)},domProps:{value:e,checked:e===t.method.type},on:{change:function(e){return t.onChange(e,"type")}}}),t._v(" "),a("label",{staticClass:"yetitab-label",attrs:{for:"c2c-method-"+e},on:{click:function(a){return t.warnAboutMethodBra(e)}}},[t._v("\n          "+t._s(t.methods[e][0])+"\n          "),a("span",{staticClass:"yetiform-info"},[t._v(t._s(t.methods[e][1]))])])])])})),0),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:"mrd"==t.method.type,expression:"method.type == 'mrd'"}]},[a("p",[a("span",{directives:[{name:"translate",rawName:"v-translate"}]},[t._v("With the")]),t._v(" "),a("strong",{directives:[{name:"translate",rawName:"v-translate"}]},[t._v("Beginner Reduction Method")]),t._v(" "),a("span",{directives:[{name:"translate",rawName:"v-translate"}]},[t._v("\n        (MRD), you do not have to enter any parameters other than the danger level(s) given by the avalanche bulletin.\n      ")])]),t._v(" "),a("div",{staticClass:"yetiform-note"},[a("p",{directives:[{name:"translate",rawName:"v-translate"}]},[t._v("\n        As the name suggests, this method is intended for beginners. Therefore, the safety margin must be particularly\n        important. No parameter other than the danger level is specified. Orientation is ignored.\n      ")])]),t._v(" "),a("table",{staticClass:"yetiform-danger"},[a("tr",[t._m(0),t._v(" "),a("td",[a("strong",{directives:[{name:"translate",rawName:"v-translate"}]},[t._v("Danger rating - low")])]),t._v(" "),a("td",{directives:[{name:"translate",rawName:"v-translate"}]},[t._v("I must not use slopes > 40°")])]),t._v(" "),a("tr",[t._m(1),t._v(" "),a("td",[a("strong",{directives:[{name:"translate",rawName:"v-translate"}]},[t._v("Danger rating - moderate")])]),t._v(" "),a("td",{directives:[{name:"translate",rawName:"v-translate"}]},[t._v("I must not use slopes > 35°")])]),t._v(" "),a("tr",{staticClass:"multiline"},[t._m(2),t._v(" "),a("td",[a("strong",{directives:[{name:"translate",rawName:"v-translate"}]},[t._v("Danger rating - considerable")])]),t._v(" "),a("td",[a("span",{directives:[{name:"translate",rawName:"v-translate"}]},[t._v("I must not use slopes > 30°")]),t._v(" "),a("br"),t._v(" "),a("small",{directives:[{name:"translate",rawName:"v-translate"}]},[t._v("including dominant slopes")])])]),t._v(" "),a("tr",[t._m(3),t._v(" "),a("td",[a("strong",{directives:[{name:"translate",rawName:"v-translate"}]},[t._v("Danger rating - high to very high")])]),t._v(" "),a("td",{directives:[{name:"translate",rawName:"v-translate"}]},[t._v("I choose to cancel the outing")])])])]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:"mre"==t.method.type,expression:"method.type == 'mre'"}]},[a("p",[a("span",{directives:[{name:"translate",rawName:"v-translate"}]},[t._v("With the")]),t._v(" "),a("strong",{directives:[{name:"translate",rawName:"v-translate"}]},[t._v("Elementary Reduction Method")]),t._v(" "),a("span",{directives:[{name:"translate",rawName:"v-translate"}]},[t._v("\n        (MRE), you can enter the sectors of the compass rose that are reported as critical in the avalanche bulletin.\n      ")])]),t._v(" "),a("input-orientation",{staticClass:"has-text-centered",attrs:{value:t.method.orientation},on:{input:function(e){return t.onChange(e,"orientation")}}}),t._v(" "),0!=t.method.orientation.length?a("p",{staticClass:"yetiform-info"},[a("span",{directives:[{name:"translate",rawName:"v-translate"}],key:"tr1"},[t._v("Orientations")]),t._v(": "+t._s(t.method.orientation.join(", "))+"\n    ")]):a("p",{staticClass:"yetiform-info"},[a("span",{directives:[{name:"translate",rawName:"v-translate"}],key:"tr2"},[t._v("No orientation selected")])]),t._v(" "),a("div",{staticClass:"yetiform-note"},[a("p",{directives:[{name:"translate",rawName:"v-translate"}]},[t._v("\n        Danger level from the avalanche bulletin applies to all orientations. The compass rose distinguishes the most\n        critical sectors presenting an increased risk.\n      ")])]),t._v(" "),a("table",{staticClass:"yetiform-danger"},[a("tr",{staticClass:"multiline"},[t._m(4),t._v(" "),a("td",[a("strong",{directives:[{name:"translate",rawName:"v-translate"}]},[t._v("Danger rating - low")])]),t._v(" "),a("td",[a("span",{directives:[{name:"translate",rawName:"v-translate"}]},[t._v("Stay careful while skiing")]),t._v(" "),a("br"),t._v(" "),a("small",{directives:[{name:"translate",rawName:"v-translate"}]},[t._v("risk of a rough fall on hard snow")])])]),t._v(" "),a("tr",[t._m(5),t._v(" "),a("td",[a("strong",{directives:[{name:"translate",rawName:"v-translate"}]},[t._v("Danger rating - moderate")])]),t._v(" "),a("td",{directives:[{name:"translate",rawName:"v-translate"}]},[t._v("I must not use slopes > 40°")])]),t._v(" "),a("tr",{staticClass:"multiline"},[t._m(6),t._v(" "),a("td",[a("strong",{directives:[{name:"translate",rawName:"v-translate"}]},[t._v("Danger rating - considerable")])]),t._v(" "),a("td",[a("span",{directives:[{name:"translate",rawName:"v-translate"}]},[t._v("I must not use slopes > 35°")]),t._v(" "),a("br"),t._v(" "),a("small",{directives:[{name:"translate",rawName:"v-translate"}]},[t._v("including dominant slopes")])])]),t._v(" "),a("tr",{staticClass:"multiline"},[t._m(7),t._v(" "),a("td",[a("strong",{directives:[{name:"translate",rawName:"v-translate"}]},[t._v("Danger rating - high")])]),t._v(" "),a("td",[a("span",{directives:[{name:"translate",rawName:"v-translate"}]},[t._v("I must not use slopes > 30°")]),t._v(" "),a("br"),t._v(" "),a("small",{directives:[{name:"translate",rawName:"v-translate"}]},[t._v("including dominant slopes")])])]),t._v(" "),a("tr",[t._m(8),t._v(" "),a("td",[a("strong",{directives:[{name:"translate",rawName:"v-translate"}]},[t._v("Danger rating - very high")])]),t._v(" "),a("td",{directives:[{name:"translate",rawName:"v-translate"}]},[t._v("I choose to cancel the outing")])])])],1),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:"mrp"==t.method.type,expression:"method.type == 'mrp'"}]},[a("p",[a("span",{directives:[{name:"translate",rawName:"v-translate"}]},[t._v("With the")]),t._v(" "),a("strong",{directives:[{name:"translate",rawName:"v-translate"}]},[t._v("Professional Reduction Method")]),t._v(" "),a("span",{directives:[{name:"translate",rawName:"v-translate"}]},[t._v("\n        (MRP), you can refine the hazard potential, set group size and any precautionary measures being considered.\n      ")])]),t._v(" "),a("h3",{directives:[{name:"translate",rawName:"v-translate"}],staticClass:"title is-3"},[t._v("Hazard potential")]),t._v(" "),a("ul",{staticClass:"potential-danger-labels has-text-black"},t._l(t.potentialDangerLabels,(function(e){return a("li",{key:e.text,staticClass:"potential-danger-label is-size-5",attrs:{disabled:!t.bra.high||e.text<t.potentialDangerOptions.min||e.text>t.potentialDangerOptions.max,selected:t.method.potentialDanger==e.text},on:{click:function(a){return t.onChange(e.text,"potentialDanger")}}},[a("span",{class:{"is-size-3 has-text-weight-bold":e.val}},[t._v("\n          "+t._s(e.text)+"\n        ")])])})),0),t._v(" "),t.method.potentialDanger?a("p",{staticClass:"yetiform-info"},[a("span",{directives:[{name:"translate",rawName:"v-translate"}],key:"tr1"},[t._v("Hazard potential:")]),t._v("\n      "+t._s(t.method.potentialDanger)+"\n      ("),a("span",{directives:[{name:"translate",rawName:"v-translate"}]},[t._v("Danger level:")]),t._v(" "+t._s(t.bra.high)+")\n    ")]):a("p",{staticClass:"yetiform-info"},[a("span",{directives:[{name:"translate",rawName:"v-translate"}],key:"tr2"},[t._v("No selected hazard potential. Set danger level first.")])]),t._v(" "),a("div",{staticClass:"yetiform-note"},[a("p",{directives:[{name:"translate",rawName:"v-translate"}]},[t._v("\n        The hazard potential is calculated from the danger level of the avalanche bulletin. It can be fine-tuned by\n        selecting a potential within the danger level’s corresponding range. For example: the avalanche bulletin\n        evokes a danger 3 just after a period in danger 4. We can then indicate a hazard potential of 12 instead of 8.\n      ")])]),t._v(" "),a("p",[a("input-checkbox",{attrs:{value:t.method.wetSnow},on:{input:function(e){return t.onChange(e,"wetSnow")}}},[a("span",{directives:[{name:"translate",rawName:"v-translate"}]},[t._v("Wet snow: orientation not taken into account")])])],1),t._v(" "),a("div",{staticClass:"yetiform-note"},[a("p",{directives:[{name:"translate",rawName:"v-translate"}]},[t._v("Be careful, in wet snow, no factor to reduce orientation or attendance can be applied.")])]),t._v(" "),a("h3",{directives:[{name:"translate",rawName:"v-translate"}],staticClass:"title is-3"},[t._v("Group")]),t._v(" "),a("ul",t._l(t.groupSizes,(function(e,r){return a("li",{key:r,staticClass:"control"},[a("input",{staticClass:"is-checkradio is-primary",attrs:{id:"c2c-group-size-"+r,type:"radio",name:"groupSize"},domProps:{value:e.value,checked:e.value===t.method.groupSize},on:{change:function(e){return t.onChange(e,"groupSize")}}}),t._v(" "),a("label",{attrs:{for:"c2c-group-size-"+r}},[t._v(t._s(e.text))])])})),0),t._v(" "),a("div",{staticClass:"yetiform-note"},[a("p",{directives:[{name:"translate",rawName:"v-translate"}]},[t._v("Group size")]),t._v(" "),a("ul",{staticClass:"content-ul"},[a("li",{directives:[{name:"translate",rawName:"v-translate"}]},[t._v("Large group = 5 people and more")]),t._v(" "),a("li",{directives:[{name:"translate",rawName:"v-translate"}]},[t._v("Small group = 2 to 4 people")])]),t._v(" "),a("p",{directives:[{name:"translate",rawName:"v-translate"}]},[t._v("Load shedding distance")]),t._v(" "),a("ul",{staticClass:"content-ul"},[a("li",{directives:[{name:"translate",rawName:"v-translate"}]},[t._v("10 meters minimum while ascending")]),t._v(" "),a("li",{directives:[{name:"translate",rawName:"v-translate"}]},[t._v("50 meters while descending")])])]),t._v(" "),a("p",{directives:[{name:"translate",rawName:"v-translate"}]},[t._v("\n      The “slope traveled frequently” factor is not taken into account by the application, as it is often difficult to\n      ascertain when preparing for an outing.\n    ")])])],1)},ht=[function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("td",[r("img",{attrs:{src:a("60a4")+"#level1",loading:"lazy"}})])},function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("td",[r("img",{attrs:{src:a("60a4")+"#level2",loading:"lazy"}})])},function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("td",[r("img",{attrs:{src:a("60a4")+"#level3",loading:"lazy"}})])},function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("td",[r("img",{attrs:{src:a("60a4")+"#level4",loading:"lazy"}})])},function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("td",[r("img",{attrs:{src:a("60a4")+"#level1",loading:"lazy"}})])},function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("td",[r("img",{attrs:{src:a("60a4")+"#level2",loading:"lazy"}})])},function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("td",[r("img",{attrs:{src:a("60a4")+"#level3",loading:"lazy"}})])},function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("td",[r("img",{attrs:{src:a("60a4")+"#level4",loading:"lazy"}})])},function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("td",[r("img",{attrs:{src:a("60a4")+"#level4",loading:"lazy"}})])}];const ct={min:1,max:16,bra:[{min:1,max:2,val:2},{min:3,max:6,val:4},{min:6,max:12,val:8},{min:13,max:16,val:16}]};var vt,dt,mt={components:{SubPanelTitle:m},data(){return{methods:{mrd:["MRD",this.$gettext("Beginner")],mre:["MRE",this.$gettext("Elementary")],mrp:["MRP",this.$gettext("Expert")]},groupSizes:[{value:1,text:this.$gettext("No reduction factor")},{value:2.1,text:this.$gettext("Large group with load shedding distance")},{value:2.2,text:this.$gettext("Small group without distance")},{value:3,text:this.$gettext("Small group with load shedding distance")}]}},computed:{bra(){return F.bra},method(){return F.method},potentialDangerLabels(){const t=[];for(let e=ct.min;e<=ct.max;e++){const a={text:e};2!==e&&4!==e&&8!==e&&16!==e||(a.val=e),t.push(a)}return t},potentialDangerOptions(){return this.bra.high?ct.bra[this.bra.high-1]:{val:void 0,min:1,max:16}}},watch:{"bra.high":"onBraChange"},methods:{onChange(t,e){let a=null;a="orientation"===e||"wetSnow"===e||"potentialDanger"===e?t:t.target.value,F.setMethod(e,a)},warnAboutMethodBra(t){this.$emit("warn-about-method-bra",t)},onBraChange(){this.onChange(this.potentialDangerOptions.val,"potentialDanger")}}},pt=mt,ft=(a("301b"),Object(c["a"])(pt,ut,ht,!1,null,"5a137fd0",null)),gt=ft.exports,yt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"column pb-0 mb-0 tabs is-boxed yetitabs"},[a("ul",{attrs:{role:"tablist"}},t._l(t.tabs,(function(e,r){return a("li",{key:e,class:{"is-active":t.activeTab===r},attrs:{role:"presentation"}},[a("a",{ref:"tab",refInFor:!0,staticClass:"yetitabs-link",attrs:{role:"tab",href:"#panel"+r,id:"tab"+r,"aria-selected":t.activeTab===r,tabindex:t.activeTab!==r&&-1},on:{click:function(e){return e.preventDefault(),t.setActiveTab(r)},keydown:function(e){return t.setActiveTabKeyboard(e,r)}}},[t._v("\n        "+t._s(e)+" "),1===r&&t.hasFeatures?a("counter",{attrs:{"is-primary":""}},[t._v("1")]):t._e()],1)])})),0)])},wt=[],_t={components:{Counter:V},props:{tabs:{type:Array,required:!0}},computed:{activeTab(){return F.activeTab},hasFeatures(){return F.hasFeatures}},methods:{setActiveTab(t){this.$refs.tab[t].focus(),F.setActiveTab(t)},setActiveTabKeyboard(t,e){const a=37,r=39,i=40;let n=t.which===a?e-1:t.which===r?e+1:t.which===i?"down":null;null!==n&&(t.preventDefault(),"down"===n?this.$parent.$refs["panel"+e].$el.focus():this.tabs[n]&&this.setActiveTab(n))}}},bt=_t,xt=(a("0489"),Object(c["a"])(bt,yt,wt,!1,null,"4a2f5c0a",null)),Et=xt.exports,St=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"columns"},[a("div",{staticClass:"column has-text-right"},[a("button",{directives:[{name:"translate",rawName:"v-translate"}],staticClass:"button is-primary",class:{"is-loading":t.loading},attrs:{disabled:t.loading,tabindex:t.tabindex},on:{click:function(e){return t.$emit("click")}}},[t._v("\n      Compute risk\n    ")]),t._v(" "),t.currentError?a("p",{staticClass:"yetiform-error"},[a("span",[t._v("\n        "+t._s(t.currentError)+"\n      ")])]):t._e()])])},kt=[],Ct={props:{currentError:{type:String,default:""},loading:{type:[Promise,Object],default:null},tabindex:{type:String,default:"0"}}},Mt=Ct,Lt=(a("efa0"),Object(c["a"])(Mt,St,kt,!1,null,"ad96ba08",null)),Nt=Lt.exports,Pt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"column map-container"},[a("div",{staticStyle:{width:"100%",height:"100%"}},[a("div",{ref:"map",staticStyle:{width:"100%",height:"100%"}}),t._v(" "),a("area-layer"),t._v(" "),a("avalanche-bulletins-layer"),t._v(" "),a("yeti-layer",{attrs:{data:t.yetiData,extent:t.yetiExtent}}),t._v(" "),a("route-layer"),t._v(" "),a("div",{ref:"layerSwitcherButton",staticClass:"ol-control ol-control-layer-switcher-button",attrs:{title:t.$gettext("Layers","Map controls")}},[a("button",{on:{click:function(e){e.stopPropagation(),t.showLayerSwitcher=!t.showLayerSwitcher}}},[a("fa-icon",{attrs:{icon:"layer-group"}})],1)]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.showLayerSwitcher,expression:"showLayerSwitcher"}],ref:"layerSwitcher",staticClass:"ol-control ol-control-layer-switcher",on:{click:function(t){t.stopPropagation()}}},[a("div",[a("header",{directives:[{name:"translate",rawName:"v-translate"}]},[t._v("Base layer")]),t._v(" "),t._l(t.cartoLayers,(function(e,r){return a("div",{key:e.get("title")},[a("input",{attrs:{id:"carto-checkbox"+r,type:"radio"},domProps:{checked:e==t.visibleCartoLayer},on:{change:function(a){t.visibleCartoLayer=e}}}),t._v(" "),a("label",{attrs:{for:"carto-checkbox"+r}},[t._v(t._s(t.$gettext(e.get("title"),"Map layer")))])])}))],2),t._v(" "),a("div",[a("header",{directives:[{name:"translate",rawName:"v-translate"}]},[t._v("Slopes")]),t._v(" "),t._l(t.dataLayers,(function(e,r){return a("div",{key:e.get("title")},[a("input",{attrs:{id:"data-checkbox"+r,type:"checkbox"},domProps:{checked:e.getVisible()},on:{change:function(a){return t.toggleMapDataLayer(e)}}}),t._v(" "),a("label",{attrs:{for:"data-checkbox"+r}},[t._v(t._s(t.$gettext(e.get("title"),"Map slopes layer")))])])})),t._v(" "),a("header",[t._v("YETI")]),t._v(" "),t._l(t.yetiLayers,(function(e,r){return a("div",{key:e.title},[a("input",{attrs:{id:"yeti-checkbox"+r,type:"checkbox"},domProps:{checked:t.showAvalancheBulletins},on:{change:e.action}}),t._v(" "),a("label",{attrs:{for:"yeti-checkbox"+r}},[t._v(t._s(e.title))])])}))],2)]),t._v(" "),a("div",{ref:"recenterOnControl",staticClass:"ol-control ol-control-recenter-on"},[a("input",{attrs:{type:"text",placeholder:t.$gettext("Recenter on...")},on:{input:t.searchRecenterPropositions}})]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.showRecenterOnPropositions,expression:"showRecenterOnPropositions"}],ref:"recenterOnPropositions",staticClass:"ol-control ol-control-recenter-on-propositions"},[t.recenterPropositions&&t.recenterPropositions.data&&t.recenterPropositions.data.features?a("ul",t._l(t.recenterPropositions.data.features,(function(e,r){return a("li",{key:r,on:{click:function(a){return t.recenterOn(e)}}},[t._v("\n          "+t._s(e.properties.name)+",\n          "),a("small",[t._v(t._s(e.properties.state)+", "+t._s(e.properties.country))])])})),0):t._e()])],1)])},Ft=[],Dt=a("9f59"),It={computed:{map(){return this.$parent.map},view(){return this.map.getView()}},methods:{getExtent(t){return this.$parent.getExtent(t)},getFeaturesFromData(t){let e=t.data;return(new rt["a"].format.GeoJSON).readFeatures(e,{featureProjection:"EPSG:3857"})},getPropertiesFromFeatures(t){return t.map(t=>t.getProperties())}}},Ot={mixins:[It],computed:{mapZoom(){return F.mapZoom},areas(){return F.areas},areasLayerStyle(){let t=2,e=4,a=Math.max(0,Math.min(this.mapZoom-6,t)),r=Math.max(0,Math.min(this.mapZoom-6,e))/4,i=6*r;return new rt["a"].style.Style({stroke:new rt["a"].style.Stroke({color:"hsla(30, 100%, 40%,"+r+")",width:a,lineDash:[i]})})}},mounted(){this.areasLayer=new rt["a"].layer.Vector({renderMode:"image",source:new rt["a"].source.Vector,style:this.areasLayerStyle}),this.map.addLayer(this.areasLayer),0===this.areas.length&&(F.fetchAreas().then(this.onAreasResult),F.$on("mapMoveEnd",this.onMapMoveEnd))},methods:{onAreasResult(t){let e=this.getFeaturesFromData(t),a=this.getPropertiesFromFeatures(e);F.setAreas(a);let r=e[0].getGeometry().getCoordinates(),i=[];for(let s=0;s<r.length;s++)i.push(...r[s]);let n=[];for(let s=0;s<i.length;s++)for(let t=0;t<i[s].length-1;t++)n.push(new rt["a"].Feature(new rt["a"].geom.LineString([i[s][t],i[s][t+1]])));this.areasLayer.getSource().addFeatures(n),this.isAreaOK()},isAreaOK(){let t=this.getExtent("EPSG:3857"),e=!0;for(let a in this.areas){let r=this.areas[a].geometry;if(r.intersectsExtent(t))break;e=!1}F.setAreaOk(e)},onMapMoveEnd(){this.isAreaOK(),this.areasLayer.setStyle(this.areasLayerStyle)}},render(){return null}},$t=Ot,At=Object(c["a"])($t,vt,dt,!1,null,null,null),Rt=At.exports,Tt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{ref:"bulletinsOverlay",staticClass:"bulletins-overlay"},[a("button",{staticClass:"delete is-small button-close",on:{click:t.closeOverlay}},[t._v("x")]),t._v(" "),a("div",{staticClass:"bulletins-header pt-5 pb-3 has-text-centered"},[a("p",{staticClass:"title is-5"},[t._v(t._s(t.overlayData.mountainName))])]),t._v(" "),t.overlayData.danger.low?a("div",{staticClass:"py-2"},[a("p",{staticClass:"is-size-7 px-3 pb-5 bulletins-date"},[a("strong",{directives:[{name:"translate",rawName:"v-translate"}]},[t._v("Validity date:")]),t._v(" "+t._s(t.overlayValidUntil)+"\n    ")]),t._v(" "),a("div",{staticClass:"is-flex is-justify-content-space-around is-align-items-center px-3"},[a("div",[a("svg",{attrs:{viewBox:t.overlayData.danger.altitude?"0 0 150 100":"0 0 100 100",width:t.overlayData.danger.altitude?120:80,height:"80"}},[a("polygon",{staticStyle:{fill:"none",stroke:"#000","stroke-miterlimit":"10","stroke-width":"1.5"},attrs:{points:"2.2,89.5 97.5,89.5 62.7,11.9 48,32.9 31.8,25.5 "}}),t._v(" "),a("text",{attrs:{x:"50",y:t.overlayData.danger.high?82:65,"text-anchor":"middle","font-family":"sans-serif","font-size":"20px","font-weight":"bold"}},[a("tspan",[t._v(t._s(t.overlayData.danger.low))]),t._v(" "),t.overlayData.danger.lowEvol?a("tspan",[t._v(" ")]):t._e(),t._v(" "),t.overlayData.danger.lowEvol?a("tspan",[t._v(t._s(t.overlayData.danger.lowEvol))]):t._e()]),t._v(" "),t.overlayData.danger.lowEvol?a("g",{staticStyle:{fill:"none",stroke:"#000","stroke-width":"2"}},[a("line",{attrs:{x1:"45",x2:"55",y1:t.overlayData.danger.high?75:58,y2:t.overlayData.danger.high?75:58}}),t._v(" "),a("line",{attrs:{x1:"50",x2:"55",y1:t.overlayData.danger.high?70:53,y2:t.overlayData.danger.high?75:58}}),t._v(" "),a("line",{attrs:{x1:"50",x2:"55",y1:t.overlayData.danger.high?80:63,y2:t.overlayData.danger.high?75:58}})]):t._e(),t._v(" "),a("g",{directives:[{name:"show",rawName:"v-show",value:t.overlayData.danger.high,expression:"overlayData.danger.high"}]},[a("line",{staticStyle:{fill:"none",stroke:"#000","stroke-miterlimit":"10","stroke-width":"1.5"},attrs:{x1:"10",y1:"61.5",x2:"90",y2:"61.5"}}),t._v(" "),a("text",{attrs:{x:"50",y:"54","text-anchor":"middle","font-family":"sans-serif","font-size":"20px","font-weight":"bold"}},[a("tspan",[t._v(t._s(t.overlayData.danger.high))]),t._v(" "),t.overlayData.danger.highEvol?a("tspan",[t._v(" ")]):t._e(),t._v(" "),t.overlayData.danger.highEvol?a("tspan",[t._v(t._s(t.overlayData.danger.highEvol))]):t._e()]),t._v(" "),t.overlayData.danger.highEvol?a("g",{staticStyle:{fill:"none",stroke:"#000","stroke-width":"2"}},[a("line",{attrs:{x1:"45",x2:"55",y1:"46",y2:"46"}}),t._v(" "),a("line",{attrs:{x1:"50",x2:"55",y1:"41",y2:"46"}}),t._v(" "),a("line",{attrs:{x1:"50",x2:"55",y1:"51",y2:"46"}})]):t._e()]),t._v(" "),t.overlayData.danger.altitude?a("text",{attrs:{x:"92",y:"65","font-family":"sans-serif","font-size":"16px","font-weight":"bold"}},[t._v("\n            "+t._s(t.overlayData.danger.altitude)+"m\n          ")]):t._e()])]),t._v(" "),a("input-orientation",{attrs:{value:t.overlayOrientations}})],1),t._v(" "),t.overlayDangerComment||t.overlayOrientationsComment?a("dl",{staticClass:"is-size-6 px-3 pt-3"},[t.overlayDangerComment?a("div",[a("dt",{directives:[{name:"translate",rawName:"v-translate"}]},[t._v("Danger:")]),t._v(" "),a("dd",[t._v(t._s(t.overlayDangerComment))])]):t._e(),t._v(" "),t.overlayOrientationsComment?a("div",[a("dt",{directives:[{name:"translate",rawName:"v-translate"}]},[t._v("Orientations:")]),t._v(" "),a("dd",[t._v(t._s(t.overlayOrientationsComment))])]):t._e()]):t._e()]):a("div",{staticClass:"py-2"},[a("p",{staticClass:"is-size-6 p-3"},[a("span",{directives:[{name:"translate",rawName:"v-translate"}]},[t._v("No avalanche bulletin right now")])])]),t._v(" "),a("p",{staticClass:"is-size-7 px-3 pt-2 pb-2 bulletins-footer"},[a("strong",{directives:[{name:"translate",rawName:"v-translate"}]},[t._v("Full bulletin:")]),t._v(" "),t._l(t.overlayData.urls,(function(e,r){return a("span",{key:r,staticClass:"pl-1"},[a("a",{attrs:{href:e.url,target:"_blank"}},[a("fa-icon",{attrs:{icon:"external-link-alt"}}),t._v(" "+t._s(e.title))],1)])}))],2),t._v(" "),a("img",{staticClass:"bulletins-overlay-danger-icon",attrs:{src:t.overlayDangerIcon,alt:""}})])},Bt=[];function zt(t,e,a){void 0===a&&(a={});var r={type:"Feature"};return(0===a.id||a.id)&&(r.id=a.id),a.bbox&&(r.bbox=a.bbox),r.properties=e||{},r.geometry=t,r}function Gt(t,e,a){void 0===a&&(a={});for(var r=0,i=t;r<i.length;r++){var n=i[r];if(n.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var s=0;s<n[n.length-1].length;s++)if(n[n.length-1][s]!==n[0][s])throw new Error("First and last Position are not equivalent.")}var o={type:"Polygon",coordinates:t};return zt(o,e,a)}function jt(t,e,a){void 0===a&&(a={});var r={type:"MultiPolygon",coordinates:t};return zt(r,e,a)}function Vt(t){return"Feature"===t.type?t.geometry:t}var Zt=a("dcbe"),qt=a.n(Zt);function Ut(t,e,a){void 0===a&&(a={});var r=Vt(t),i=Vt(e),n=qt.a.intersection(r.coordinates,i.coordinates);return 0===n.length?null:1===n.length?Gt(n[0],a.properties):jt(n,a.properties)}let Yt=t=>{const e=8,a=10,r=0,i=.8;let n=i,s=1;return t&&(t>=e&&t<=a?n=i/(a-e)*(a-t):t>a&&(n=r),t>a&&(s=2)),new rt["a"].style.Style({stroke:new rt["a"].style.Stroke({color:"rgba(0, 0, 0, .85)",width:s}),fill:new rt["a"].style.Fill({color:`rgba(255, 255, 255, ${n})`})})},Wt=80,Kt=t=>{t=t||0;let e=["#999","#cbdb45","#fff100","#f6921e","#ec1c24","#ec1c24"],a=`\n    <svg xmlns="http://www.w3.org/2000/svg" width="${Wt}" height="${Wt}" viewBox="-50 0 200 100">\n      <path d="M5,50L50,5L95,50" fill="white" />\n      <path d="M5,50L50,95L95,50" fill="${e[t]}" />\n      <path d="m50,0l50,50-50,50-50-50zv5L21,33l19-10L50,26l9-8L80,38l2-1L50,5M5,50L50,95L95,50" />\n  `;return a+=0!==t?`\n      <text x="50" y="83" text-anchor="middle" font-family="sans-serif" font-size="40px" font-weight="bold">${t}</text>\n    `:'\n      <g stroke-width="5" stroke="black">\n        <line x1="40" x2="60" y1="58" y2="78" />\n        <line x1="40" x2="60" y1="78" y2="58" />\n      </g>\n    ',2===t?a+='\n      <path d="M86,45a7,7,0,106.5-13.5a7,7,0,00-10.5-8a5.4,5.4,0,00-10.2,3" />\n      <path d="M69,27L86,44a5,5,0,104-12a5,5,0,10-9-5a3,3,0,10-8,0" fill="white" />\n      <path d="M85,32a1,1,0,110,8v-2a1,1,0,100-4" />\n    ':3===t?a+='\n      <path d="M54,22L79,50h33a5,5,0,10-4-22.3a11.3,11.3,0,00-20,0q-8-2,-14,6" />\n      <path d="M55,21L82,48h30a5,5,0,10-5-18a9.7,9.7,0,00-18,0q-7-2,-11,3L60,16" fill="white" />\n      <path d="M59,18l25,25-1.5,1.5-25-25M87,38a1,1,0,1110,5l-2-1a1,1,0,10-6-3" />\n    ':4!==t&&5!==t||(a+='\n      <path d="M54,22L79,50h52a12.5,12.5,0,001.5-24.4a7,7,0,00-8.2-7a11.9,11.9,0,00-22.5-2q-11-1,-14,7q-10-2-14,4" />\n      <path d="M52,24L77,48h50a5,5,0,103-21a5,5,0,00-7-6a10.3,10.3,0,00-20-2q-11-2,-14,7q-10-3-14,4L60,16" fill="white" />\n      <path d="M59,18l25,25-1.5,1.5-25-25m-1.5,1.5l22.5,22.5-1.5,1.5-22.5-22.5M87,38a1,1,0,1110,5l-2-1a1,1,0,10-6-3M96,29a1,1,0,1115,14l-1.7-1.7A1,1,0,1097.7,30.7" />\n    '),a+="</svg>","data:image/svg+xml;charset=utf-8,"+encodeURIComponent(a)},Jt=t=>new rt["a"].style.Style({image:new rt["a"].style.Icon({src:Kt(t),size:[Wt,Wt]})}),Xt=new rt["a"].layer.Vector({source:new rt["a"].source.Vector,style:Yt()}),Ht=new rt["a"].layer.Vector({source:new rt["a"].source.Vector}),Qt=new rt["a"].layer.Group({layers:[Xt,Ht]}),te=new rt["a"].Overlay({positioning:"top-center",offset:[0,0],className:"bulletins-overlay-container"}),ee={animation:{duration:250},margin:10};var ae={mixins:[It],data(){return{overlayData:{mountainName:null,validUntil:null,danger:{},orientations:[],urls:[]},panIntoView:!1}},computed:{mapZoom(){return F.mapZoom},showAvalancheBulletins(){return F.showAvalancheBulletins},bulletinsLoaded(){return F.bulletinsLoaded},overlayOrientations(){return Object.keys(this.overlayData.orientations).filter(t=>"comment"!==t).filter(t=>this.overlayData.orientations[t]).map(t=>t.toUpperCase())},overlayValidUntil(){return Object(J["a"])(new Date(this.overlayData.validUntil),"dd/MM/yyyy HH:mm")},overlayDangerIcon(){return Kt(this.overlayData.danger.max)},overlayDangerComment(){return this.overlayData.danger.low?this.overlayData.danger.comment:null},overlayOrientationsComment(){return this.overlayData.orientations.comment}},watch:{showAvalancheBulletins(){this.onShowAvalancheBulletins()}},mounted(){this.activeBulletins=null,te.setElement(this.$refs.bulletinsOverlay),this.map.addOverlay(te),this.map.addLayer(Qt),Qt.setVisible(!1),0===F.mountains.all.length&&(F.fetchMountains().then(this.onMountainsResult),F.$on("mapMoveEnd",this.onMapMoveEnd),F.$on("mapClick",this.onMapClick))},methods:{onMountainsResult(t){let e=this.getFeaturesFromData(t);e=e.filter(t=>"France"===t.get("country")),Xt.getSource().addFeatures(e);let a=this.getPropertiesFromFeatures(e);a=this.sortMountainsByMassif(a),F.setAllMountains(a),this.setVisibleMountains()},sortMountainsByMassif(t){let e={};for(let r=0;r<t.length;r++)e[t[r].mountain]||(e[t[r].mountain]=[]),e[t[r].mountain].push(t[r]);t=Object.keys(e).sort().reduce((t,a)=>(t[a]=e[a],t),{});let a="name";for(let r in t)t[r].sort((t,e)=>t[a]<e[a]?-1:t[a]>e[a]?1:0);return t},setVisibleMountains(){let t=this.getExtent("EPSG:3857"),e=Object.assign({},F.mountains.all);for(let a in e)e[a]=e[a].filter(e=>{let a=e.geometry;return a.intersectsExtent(t)}),0===e[a].length&&delete e[a];F.setVisibleMountains(e)},updateMountainsStyle(){Xt.setStyle(Yt(this.mapZoom))},onMapMoveEnd(){this.setVisibleMountains(),this.showAvalancheBulletins&&(this.updateMountainsStyle(),this.updateBulletinsGeometry())},onMapClick(t){this.showAvalancheBulletins&&this.setBulletinsOverlay(t)},onShowAvalancheBulletins(){this.bulletinsLoaded||(F.setBulletinsLoaded(!0),F.fetchBulletins().then(this.onBulletinsResult)),Qt.setVisible(this.showAvalancheBulletins),this.updateMountainsStyle(),this.updateBulletinsGeometry()},onBulletinsResult(t){let e=t.data,a=Xt.getSource().getFeatures();e.zones.forEach(t=>{a.find(e=>{if(e.get("name")===t.zone){let a=e.getGeometry(),r=a.getType(),i=null;if("MultiPolygon"!==r)throw new Error("Mountain geometry have to be MultiPolygon.");i=a.getInteriorPoints();let n=new rt["a"].Feature({geometry:i,initialGeometry:i,overlayData:{mountainName:e.get("name"),validUntil:t.validUntil,danger:t.danger,orientations:t.orientations,urls:e.get("urls")}});return Ht.getSource().addFeature(n),n.setStyle(Jt(t.danger.max)),e.setProperties({bulletinsFeature:n}),!0}})}),this.updateBulletinsGeometry()},updateBulletinsGeometry(){if(this.bulletinsLoaded){if(this.panIntoView)return this.panIntoView=!1,void this.updateBulletinsOverlay();if(this.mapZoom>10){let t=this.getExtent("EPSG:3857"),e=new rt["a"].Feature(rt["a"].geom.polygonFromExtent(t)),a=Xt.getSource().getFeatures();a.forEach(t=>{let a=Ut((new rt["a"].format.GeoJSON).writeFeatureObject(t),(new rt["a"].format.GeoJSON).writeFeatureObject(e));if(a){let e=(new rt["a"].format.GeoJSON).readFeature(a),r=e.getGeometry(),i=r.getType();"Polygon"===i&&(e=new rt["a"].Feature({geometry:new rt["a"].geom.MultiPolygon([r])}));let n=e.getGeometry().getInteriorPoints(),s=t.get("bulletinsFeature");s&&s.setGeometry(n)}})}else{let t=Ht.getSource().getFeatures();t.forEach(t=>{t.setGeometry(t.get("initialGeometry"))})}this.updateBulletinsOverlay()}},setBulletinsOverlay(t){let e=this.map.getFeaturesAtPixel(t.pixel,{layerFilter:function(t){return t===Ht}}),a=e.length?e[0]:void 0;if(a){this.overlayData=a.get("overlayData");let e=a.getGeometry().getClosestPoint(t.coordinate);this.openOverlay(e,!0),this.activeBulletins={feature:a};let r=a.getGeometry().getPoints();r.length>1&&r.forEach((t,a)=>{t.getCoordinates().every((t,a)=>t===e[a])&&(this.activeBulletins.index=a)})}else this.closeOverlay(!0)},updateBulletinsOverlay(){if(this.activeBulletins&&this.showAvalancheBulletins){let t=this.activeBulletins.feature,e=this.activeBulletins.index||0,a=t.getGeometry().getPoint(e);a||(a=t.getGeometry().getPoint(0)),this.openOverlay(a.getCoordinates())}else this.closeOverlay()},openOverlay(t,e=!1){this.$nextTick(()=>{te.setPosition(t),e&&(this.panIntoView=!0,te.panIntoView(ee))})},closeOverlay(t=!1){te.setPosition(void 0),t&&(this.activeBulletins=null)}}},re=ae,ie=(a("1993"),a("e7e3"),Object(c["a"])(re,Tt,Bt,!1,null,"0c5430bf",null)),ne=ie.exports;a("5319");let se=new rt["a"].style.Style({stroke:new rt["a"].style.Stroke({color:"yellow",width:3})}),oe=[new rt["a"].style.Style({stroke:new rt["a"].style.Stroke({color:"rgba(255, 255, 0, .5)",width:8}),zIndex:1}),new rt["a"].style.Style({stroke:new rt["a"].style.Stroke({color:"red",width:3}),zIndex:1})];var le,ue,he={mixins:[It],computed:{activeTab(){return F.activeTab},features(){return F.features},validMinimumMapZoom(){return F.VALID_MINIMUM_MAP_ZOOM}},watch:{activeTab(){0===this.activeTab?(this.drawInteraction.setActive(!1),this.modifyInteraction.setActive(!1),this.snapInteraction.setActive(!1)):(this.drawInteraction.setActive(!0),this.modifyInteraction.setActive(!0),this.snapInteraction.setActive(!0))}},mounted(){this.featuresLayer=new rt["a"].layer.Vector({source:new rt["a"].source.Vector,style:se}),this.featuresLayerSource=this.featuresLayer.getSource(),this.map.addLayer(this.featuresLayer),F.setFeaturesTitle(this.$gettext(F.featuresTitle));let t=this.$route.params.document_id,e=this.$language.current;t&&p["a"]["route"].getCooked(t,e).then(this.addFeaturesFromDocument),this.featuresLayerSource.on("addfeature",this.onFeature),this.addInteractions(),F.$on("removeFeature",this.removeFeature),F.$on("removeFeatures",this.removeFeatures),F.$on("gpx",this.addFeaturesFromGpx)},methods:{addInteractions(){let t=this.featuresLayerSource;this.modifyInteraction=new rt["a"].interaction.Modify({source:t}),this.map.addInteraction(this.modifyInteraction),this.drawInteraction=new rt["a"].interaction.Draw({source:t,type:"LineString"}),this.map.addInteraction(this.drawInteraction),this.snapInteraction=new rt["a"].interaction.Snap({source:t}),this.map.addInteraction(this.snapInteraction),this.drawInteraction.on("drawstart",this.onDrawStart),this.drawInteraction.on("drawend",this.onDrawEnd),this.modifyInteraction.on("modifyend",this.onModifyEnd),this.drawInteraction.setActive(!1),this.modifyInteraction.setActive(!1),this.snapInteraction.setActive(!1)},onDrawStart(){document.addEventListener("keydown",this.onKeyWhileDrawing),document.addEventListener("keypress",this.onKeyWhileDrawing)},onDrawEnd(){document.removeEventListener("keydown",this.onKeyWhileDrawing),document.removeEventListener("keypress",this.onKeyWhileDrawing)},onModifyEnd(){this.updateFeaturesFromStore()},onKeyWhileDrawing(t){t.preventDefault(),"Backspace"===t.key&&this.drawInteraction.removeLastPoint()},onFeature(t){t.feature.set("highlightedStyle",oe),this.loadingExternalFeatures||this.updateFeaturesFromStore()},updateFeaturesFromStore(){let t=this.getFeaturesLayerFeatures();F.setFeatures(t),0===t.length&&this.$route.params.document_id&&this.$router.replace({path:"/"+this.$route.name})},getFeaturesLayerFeatures(){return this.featuresLayerSource.getFeatures()},removeFeature(t){let e=!(1===this.featuresLayerSource.getFeatures().length&&!confirm(this.$gettext("Confirm delete")));e&&(this.featuresLayerSource.removeFeature(t),this.updateFeaturesFromStore())},removeFeatures(){this.featuresLayerSource.clear(!0),this.updateFeaturesFromStore()},addFeaturesFromGpx(t){if(!t)return;this.featuresLayerSource.clear(!0),this.loadingExternalFeatures=!0;let e=new rt["a"].format.GPX,a=e.readFeatures(t,{featureProjection:"EPSG:3857"});a.map(this.addFeature),F.setFeaturesTitle(this.getFeaturesTitleFromGpx(a)),this.loadingExternalFeatures=!1,this.updateFeaturesFromStore(),this.fitMapToFeatures()},getFeaturesTitleFromGpx(t){if(t&&t.length){let e=t[0].getProperties();return e.name?e.name:this.$gettext("GPX file")}},addFeaturesFromDocument(t){this.loadingExternalFeatures=!0;let e=t.data.geometry.geom_detail,a=(new rt["a"].format.GeoJSON).readFeature(e);this.addFeature(a),F.setFeaturesTitle(this.getFeaturesTitleFromDocument(t)),this.loadingExternalFeatures=!1,this.updateFeaturesFromStore(),this.fitMapToFeatures()},addFeature(t){if("MultiLineString"===t.getGeometry().getType()){let e=t.getGeometry().getLineStrings();e.map(t=>new rt["a"].Feature({geometry:t})).map(this.addFeature)}else{let e=t.getGeometry().getCoordinates().length;e>=2&&this.featuresLayerSource.addFeature(t)}},getFeaturesTitleFromDocument(t){return this.$documentUtils.getDocumentTitle(t.data)},fitMapToFeatures(){let t=rt["a"].extent.createEmpty();rt["a"].extent.extend(t,this.featuresLayerSource.getExtent()),this.view.fit(t,{size:this.map.getSize()}),this.view.setZoom(Math.max(this.validMinimumMapZoom,this.view.getZoom()))}},render(){return null}},ce=he,ve=Object(c["a"])(ce,le,ue,!1,null,null,null),de=ve.exports,me=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"legend"},[a("div",[a("div",{staticClass:"legend-button is-pulled-right ol-control"},[a("button",{attrs:{type:"button"},on:{click:function(e){t.showLegend=!t.showLegend}}},[a("span",{directives:[{name:"translate",rawName:"v-translate"}]},[t._v("Legend")])])])]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:!0===t.showLegend,expression:"showLegend === true"}],staticClass:"legend-content"},[t.mapLegend?a("div",[a("ul",t._l(t.mapLegend.items,(function(e,r){return a("li",{key:r},[a("span",{staticClass:"legend-color",style:"background:"+e.color}),t._v(" "),a("span",[t._v(t._s(t.$gettext(e.text["en"])))])])})),0),t._v(" "),a("p",{staticClass:"is-size-6 is-italic"},[t._v(t._s(t.$gettext(t.mapLegend.comment["en"])))])]):a("p",{directives:[{name:"translate",rawName:"v-translate"}],staticClass:"is-italic"},[t._v("Legend will appear automatically with the generated image")])])]),t._v(" "),t.isLayerLoaded?a("div",{staticClass:"ol-control opacity"},[a("div",{staticClass:"opacity-slider"},[a("vue-slider",{attrs:{min:0,max:1,interval:.01,tooltip:"none",direction:"btt","rail-style":{background:"rgba(0,0,0,.25)"},"process-style":{background:"white"}},on:{change:t.onUpdateOpacity},model:{value:t.opacity,callback:function(e){t.opacity=e},expression:"opacity"}})],1)]):t._e()])},pe=[];a("24df");const fe="RGE ALTI®",ge=.75;var ye={components:{VueSlider:()=>a.e("slider").then(a.t.bind(null,"4971",7))},mixins:[It],props:{data:{type:String,default:null},extent:{type:Array,required:!0}},data(){return{isLayerLoaded:!1,opacity:ge,showLegend:void 0,mapLegend:null}},watch:{data(){this.data?this.drawImage():this.clearLayers()},extent(){this.drawExtent(this.extent)}},created(){this.layer=new rt["a"].layer.Image({source:new rt["a"].source.ImageStatic({url:null,imageExtent:rt["a"].extent.createEmpty()}),opacity:this.opacity}),this.extentLayer=new rt["a"].layer.Vector({source:new rt["a"].source.Vector,style:[new rt["a"].style.Style({fill:new rt["a"].style.Fill({color:"hsla(30, 100%, 60%, .45)"})}),new rt["a"].style.Style({stroke:new rt["a"].style.Stroke({color:"hsla(30, 100%, 40%, 1)",width:2}),geometry:t=>new rt["a"].geom.Polygon([t.getGeometry().getCoordinates()[1]])})]})},mounted(){this.map.addLayer(this.layer),this.map.addLayer(this.extentLayer)},methods:{clearLayers(){this.layer.setSource(null),this.isLayerLoaded=!1,this.extentLayer.getSource().clear()},drawExtent(t){let e=rt["a"].extent.buffer(t,Math.max(t[2]-t[0],t[3]-t[1])/10),a=new rt["a"].Feature(new rt["a"].geom.Polygon([this.toLinearRing(e),this.toLinearRing(t)]));this.extentLayer.getSource().addFeature(a)},drawImage(){let t=(new DOMParser).parseFromString(this.data,"application/xml"),e=t.getElementsByTagName("wps:ComplexData")[0].textContent,a=t.getElementsByTagName("wps:ComplexData")[1].textContent,r=rt["a"].proj.transformExtent(a.split(",").map(Number),"EPSG:4326","EPSG:3857");this.layer.setSource(new rt["a"].source.ImageStatic({imageLoadFunction(t){t.getImage().src="data:image/png;base64,"+e},attributions:fe,imageExtent:r})),this.isLayerLoaded=!0,this.setLegend(t)},onUpdateOpacity(){this.layer.setOpacity(this.opacity)},setLegend(t){this.mapLegend=JSON.parse(t.getElementsByTagName("wps:ComplexData")[2].textContent),this.mapLegend.items.forEach(t=>{t.color=`rgb(${t.color[0]}, ${t.color[1]}, ${t.color[2]})`})},toLinearRing(t){let e=t[0],a=t[1],r=t[2],i=t[3];return[[e,a],[e,i],[r,i],[r,a],[e,a]]}}},we=ye,_e=(a("1287"),Object(c["a"])(we,me,pe,!1,null,"00236790",null)),be=_e.exports,xe=a("c13e");const Ee=[6.25,45.15],Se=6,ke=19;var Ce={components:{AreaLayer:Rt,AvalancheBulletinsLayer:ne,RouteLayer:de,YetiLayer:be},props:{yetiExtent:{type:Array,required:!0},yetiData:{type:String,default:null}},data(){return{cartoLayers:Object(Dt["a"])(),dataLayers:Object(Dt["b"])(),yetiLayers:[{title:this.$gettext("Avalanche bulletins"),action:this.onShowAvalancheBulletins}],showLayerSwitcher:!1,recenterPropositions:null,showRecenterOnPropositions:!1}},computed:{mapZoom(){return F.mapZoom},showAvalancheBulletins(){return F.showAvalancheBulletins},visibleCartoLayer:{get(){return this.cartoLayers.find(t=>!0===t.getVisible())},set(t){this.visibleCartoLayer.setVisible(!1),t.setVisible(!0)}}},watch:{showAvalancheBulletins(){this.updateCartoLayersOpacity()}},created(){this.map=new rt["a"].Map({controls:[new rt["a"].control.Zoom({zoomInTipLabel:this.$gettext("Zoom in","Map controls"),zoomOutTipLabel:this.$gettext("Zoom out","Map controls")}),new rt["a"].control.ScaleLine,new rt["a"].control.Attribution({tipLabel:this.$gettext("Attributions","Map controls")})],layers:[...this.cartoLayers,...this.dataLayers],view:new rt["a"].View({center:rt["a"].proj.transform(Ee,"EPSG:4326","EPSG:3857"),zoom:Se,maxZoom:ke})}),this.view=this.map.getView()},mounted(){this.map.setTarget(this.$refs.map);let t=[new rt["a"].control.FullScreen({source:this.$el,tipLabel:this.$gettext("Toggle full-screen","Map Controls")}),new rt["a"].control.Control({element:this.$refs.layerSwitcherButton}),new rt["a"].control.Control({element:this.$refs.layerSwitcher}),new rt["a"].control.Control({element:this.$refs.recenterOnControl}),new rt["a"].control.Control({element:this.$refs.recenterOnPropositions})];t.map(t=>this.map.addControl(t)),this.map.on("moveend",this.onMapMoveEnd),this.map.on("click",this.onMapClick)},methods:{getExtent(t){let e=this.view.calculateExtent(this.map.getSize()||null);return t&&(e=rt["a"].proj.transformExtent(e,rt["a"].proj.get("EPSG:3857"),rt["a"].proj.get(t))),e},toggleMapDataLayer(t){t.setVisible(!t.getVisible())},searchRecenterPropositions(t){let e=t.target.value;if(e&&e.length>=3){let t=this.view.getCenter(),a=rt["a"].proj.toLonLat(t);this.recenterPropositions=xe["a"].getPropositions(e,this.$language.current,a),this.showRecenterOnPropositions=!0}},recenterOn(t){let e=(new rt["a"].format.GeoJSON).readFeature(t),a=e.get("extent"),r=e.getGeometry().flatCoordinates;a?(a=rt["a"].proj.transformExtent(a,"EPSG:4326","EPSG:3857"),this.view.fit(a,{size:this.map.getSize(),maxZoom:12})):(r=rt["a"].proj.transform(r,"EPSG:4326","EPSG:3857"),this.view.setCenter(r),this.view.setZoom(16)),this.showRecenterOnPropositions=!1},getMapZoom(){return Math.floor(10*this.view.getZoom())/10},onMapMoveEnd(){let t=this.getMapZoom();this.mapZoom!==t&&F.setMapZoom(t),this.showAvalancheBulletins&&this.updateCartoLayersOpacity(),F.$emit("mapMoveEnd")},onMapClick(t){this.showLayerSwitcher=!1,this.showRecenterOnPropositions=!1,F.$emit("mapClick",t)},updateCartoLayersOpacity(){const t=9;this.cartoLayers.forEach(e=>{e.setOpacity(this.showAvalancheBulletins&&this.mapZoom<t?.5:1)})},onShowAvalancheBulletins(){F.setShowAvalancheBulletins(!this.showAvalancheBulletins)}}},Me=Ce,Le=(a("8714"),Object(c["a"])(Me,Pt,Ft,!1,null,"9e15cf2c",null)),Ne=Le.exports;const Pe="https://api.ensg.eu/yeti-wps?request=Execute&service=WPS&version=1.0.0&identifier=Yeti&datainputs=";var Fe={name:"Yeti",components:{YetiArticle:b,Panel:$,SubPanelBra:Y,SubPanelCourse:lt,SubPanelMethods:gt,Tabs:Et,ValidationButton:Nt,YetiMap:Ne},data(){return{showDisclaimer:!1,checkDisclaimer:!1,articles:{faq:{id:1257569,title:"FAQ"},disclaimer:{id:1257571,title:this.$gettext("Disclaimer")}},tabs:[this.$gettext("Compute"),this.$gettext("Outing")],formError:void 0,currentError:void 0,promise:null,yetiData:null,yetiExtent:[]}},computed:{validMinimumMapZoom(){return F.VALID_MINIMUM_MAP_ZOOM},dangerMaxWhenMrd(){return F.DANGER_MAX_WHEN_MRD},bra(){return F.bra},method(){return F.method},mapZoom(){return F.mapZoom},areaOk(){return F.areaOk},errors(){return{area:{simple:this.$gettext("Area not covered"),full:this.$gettext("Current map view is not covered by YETI. Only french mountains are as of now (determined by a dashed stroke).")},method:{simple:this.$gettext("Missing method"),full:this.$gettext("Please select a method before computing.")},method_bra:{simple:this.$gettext("Conflicting method and danger"),full:this.$gettext("The MRD method (beginner) is allowed when danger is 3 maximum. Choose another method: MRE or MRP.")},bra:{simple:this.$gettext("Missing danger level"),full:this.$gettext("Please set danger level as specified on avalanche bulletin for the specific area.")},altitude:{simple:this.$gettext("Missing altitude"),full:this.$gettext("Altitude is mandatory when danger high and low are different. Please set altitude as specified on avalanche bulletin for the specific area.")},zoom:{simple:this.$gettext("Area too large"),full:this.$gettext("Current map view is too large. Please zoom to level")+" "+this.validMinimumMapZoom},ok:this.$gettext("Seems fine! :)"),yeti:this.$gettext("Service is inactive right now"),yeti_prefix:"YETI Service: ",yeti_unauthorized:this.$gettext("You have to be authorized. Please contact administrators of the service if interested.")}},mrdIsNotApplicable(){return this.isBraMax&&"mrd"===this.method.type},isBraMax(){return this.bra.high>this.dangerMaxWhenMrd||this.bra.low>this.dangerMaxWhenMrd},isValidMapZoom(){return this.mapZoom>=this.validMinimumMapZoom}},watch:{"bra.low":"check","bra.altiThreshold":"check","bra.isDifferent":"check","method.type":"check","method.potentialDanger":"check",mapZoom:"check",areaOk:"check"},created(){this.$localStorage.get("yeti-disclaimer")||(this.showDisclaimer=!0),F.setDefault()},mounted(){this.check()},methods:{check(){this.areaOk?this.isValidMapZoom?this.bra.high?this.bra.low&&this.bra.high!==this.bra.low&&!this.bra.altiThreshold?this.formError="altitude":this.method.type?this.mrdIsNotApplicable?this.formError="method_bra":!this.bra.isDifferent||this.bra.low&&this.bra.high?this.formError=null:this.formError="bra":this.formError="method":this.formError="bra":this.formError="zoom":this.formError="area",this.mrdIsNotApplicable&&(this.method.type=null),this.setCurrentError()},warnAboutMethodBra(t){"mrd"===t&&this.isBraMax&&window.alert(this.errors.method_bra.full)},setCurrentError(){this.formError?(this.currentError=this.errors[this.formError]["simple"],"zoom"===this.formError&&(this.currentError+=" ("+this.$gettext("current zoom:")+" "+this.mapZoom+" "+this.$gettext("on")+" "+this.validMinimumMapZoom+")")):this.currentError=this.errors["ok"]},compute(){if(this.formError)return void window.alert(this.errors[this.formError]["full"]);const t=this.$refs.map.getExtent("EPSG:3857"),e=this.extendExtent(t),a=this.getYetiUrl(e);this.yetiData=null,this.promise=s.a.get(a).then(t=>this.onYetiResult(t,e)).catch(this.onYetiError)},extendExtent(t){const e=Math.min(.5,(this.mapZoom-this.validMinimumMapZoom)/6),a=Math.max(t[2]-t[0],t[3]-t[1])*e;return rt["a"].extent.buffer(t,a)},onYetiResult(t,e){this.yetiData=t.data,this.yetiExtent=e,this.promise=null},onYetiError(t){this.promise=null;let e=this.errors["yeti"];if(400===t.response.status){const a=(new DOMParser).parseFromString(t.response.data,"text/xml");e=[...a.getElementsByTagName("ExceptionText")].map(t=>t.textContent).join(" ")}403===t.response.status&&(e=this.errors["yeti_unauthorized"]),window.alert(this.errors["yeti_prefix"]+e)},getYetiUrl(t){const e=rt["a"].proj.transformExtent(t,"EPSG:3857","EPSG:4326"),a=this.bra.isDifferent?this.bra.low:this.bra.high,r=this.bra.isDifferent?this.bra.altiThreshold:0,i="mre"===this.method.type&&0!==this.method.orientation.length?"none,"+this.method.orientation.join(",").toLowerCase():"none",n="mrp"===this.method.type?this.method.potentialDanger:0,s="mrp"===this.method.type&&this.method.wetSnow,o="mrp"===this.method.type?Math.floor(this.method.groupSize):0;let l=Pe;return l+=`methode=${this.method.type};`,l+=`bbox=${e[0]},${e[1]},${e[2]},${e[3]};`,l+=`risque_haut=${this.bra.high};`,l+=`risque_bas=${a};`,l+=`seuil_alti=${r};`,l+=`rdv=${i};`,l+=`potentiel_danger=${n};`,l+=`neige_mouillee=${s};`,l+="taille_groupe="+o,l},onSubmitDisclaimer(){this.showDisclaimer=!1,this.$localStorage.set("yeti-disclaimer","validated")}}},De=Fe,Ie=(a("377f"),a("2d99"),Object(c["a"])(De,r,i,!1,null,"403054a5",null));e["default"]=Ie.exports},"9d66":function(t,e,a){"use strict";a("e457")},"9e38":function(t,e,a){},a831:function(t,e,a){},aa66:function(t,e,a){t.exports=a.p+"img/logo-ensg.e6781953.jpg"},af24:function(t,e,a){},b600:function(t,e,a){"use strict";a("11ed")},bd20:function(t,e,a){},d315:function(t,e,a){t.exports=a.p+"img/logo-fondation-petzl.24ab8a49.webp"},da3b:function(t,e,a){},dcbe:function(t,e,a){(function(e){(function(e,a){t.exports=a()})(0,(function(){"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function r(t,e,r){return e&&a(t.prototype,e),r&&a(t,r),t}
/**
   * splaytree v3.1.0
   * Fast Splay tree for Node and browser
   *
   * @author Alexander Milevski <info@w8r.name>
   * @license MIT
   * @preserve
   */var i=function(){function t(t,e){this.next=null,this.key=t,this.data=e,this.left=null,this.right=null}return t}();function n(t,e){return t>e?1:t<e?-1:0}function s(t,e,a){var r=new i(null,null),n=r,s=r;while(1){var o=a(t,e.key);if(o<0){if(null===e.left)break;if(a(t,e.left.key)<0){var l=e.left;if(e.left=l.right,l.right=e,e=l,null===e.left)break}s.left=e,s=e,e=e.left}else{if(!(o>0))break;if(null===e.right)break;if(a(t,e.right.key)>0){l=e.right;if(e.right=l.left,l.left=e,e=l,null===e.right)break}n.right=e,n=e,e=e.right}}return n.right=e.left,s.left=e.right,e.left=r.right,e.right=r.left,e}function o(t,e,a,r){var n=new i(t,e);if(null===a)return n.left=n.right=null,n;a=s(t,a,r);var o=r(t,a.key);return o<0?(n.left=a.left,n.right=a,a.left=null):o>=0&&(n.right=a.right,n.left=a,a.right=null),n}function l(t,e,a){var r=null,i=null;if(e){e=s(t,e,a);var n=a(e.key,t);0===n?(r=e.left,i=e.right):n<0?(i=e.right,e.right=null,r=e):(r=e.left,e.left=null,i=e)}return{left:r,right:i}}function u(t,e,a){return null===e?t:(null===t||(e=s(t.key,e,a),e.left=t),e)}function h(t,e,a,r,i){if(t){r(e+(a?"└── ":"├── ")+i(t)+"\n");var n=e+(a?"    ":"│   ");t.left&&h(t.left,n,!1,r,i),t.right&&h(t.right,n,!0,r,i)}}var c=function(){function t(t){void 0===t&&(t=n),this._root=null,this._size=0,this._comparator=t}return t.prototype.insert=function(t,e){return this._size++,this._root=o(t,e,this._root,this._comparator)},t.prototype.add=function(t,e){var a=new i(t,e);null===this._root&&(a.left=a.right=null,this._size++,this._root=a);var r=this._comparator,n=s(t,this._root,r),o=r(t,n.key);return 0===o?this._root=n:(o<0?(a.left=n.left,a.right=n,n.left=null):o>0&&(a.right=n.right,a.left=n,n.right=null),this._size++,this._root=a),this._root},t.prototype.remove=function(t){this._root=this._remove(t,this._root,this._comparator)},t.prototype._remove=function(t,e,a){var r;if(null===e)return null;e=s(t,e,a);var i=a(t,e.key);return 0===i?(null===e.left?r=e.right:(r=s(t,e.left,a),r.right=e.right),this._size--,r):e},t.prototype.pop=function(){var t=this._root;if(t){while(t.left)t=t.left;return this._root=s(t.key,this._root,this._comparator),this._root=this._remove(t.key,this._root,this._comparator),{key:t.key,data:t.data}}return null},t.prototype.findStatic=function(t){var e=this._root,a=this._comparator;while(e){var r=a(t,e.key);if(0===r)return e;e=r<0?e.left:e.right}return null},t.prototype.find=function(t){return this._root&&(this._root=s(t,this._root,this._comparator),0!==this._comparator(t,this._root.key))?null:this._root},t.prototype.contains=function(t){var e=this._root,a=this._comparator;while(e){var r=a(t,e.key);if(0===r)return!0;e=r<0?e.left:e.right}return!1},t.prototype.forEach=function(t,e){var a=this._root,r=[],i=!1;while(!i)null!==a?(r.push(a),a=a.left):0!==r.length?(a=r.pop(),t.call(e,a),a=a.right):i=!0;return this},t.prototype.range=function(t,e,a,r){var i,n=[],s=this._comparator,o=this._root;while(0!==n.length||o)if(o)n.push(o),o=o.left;else{if(o=n.pop(),i=s(o.key,e),i>0)break;if(s(o.key,t)>=0&&a.call(r,o))return this;o=o.right}return this},t.prototype.keys=function(){var t=[];return this.forEach((function(e){var a=e.key;return t.push(a)})),t},t.prototype.values=function(){var t=[];return this.forEach((function(e){var a=e.data;return t.push(a)})),t},t.prototype.min=function(){return this._root?this.minNode(this._root).key:null},t.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},t.prototype.minNode=function(t){if(void 0===t&&(t=this._root),t)while(t.left)t=t.left;return t},t.prototype.maxNode=function(t){if(void 0===t&&(t=this._root),t)while(t.right)t=t.right;return t},t.prototype.at=function(t){var e=this._root,a=!1,r=0,i=[];while(!a)if(e)i.push(e),e=e.left;else if(i.length>0){if(e=i.pop(),r===t)return e;r++,e=e.right}else a=!0;return null},t.prototype.next=function(t){var e=this._root,a=null;if(t.right){a=t.right;while(a.left)a=a.left;return a}var r=this._comparator;while(e){var i=r(t.key,e.key);if(0===i)break;i<0?(a=e,e=e.left):e=e.right}return a},t.prototype.prev=function(t){var e=this._root,a=null;if(null!==t.left){a=t.left;while(a.right)a=a.right;return a}var r=this._comparator;while(e){var i=r(t.key,e.key);if(0===i)break;i<0?e=e.left:(a=e,e=e.right)}return a},t.prototype.clear=function(){return this._root=null,this._size=0,this},t.prototype.toList=function(){return m(this._root)},t.prototype.load=function(t,e,a){void 0===e&&(e=[]),void 0===a&&(a=!1);var r=t.length,i=this._comparator;if(a&&g(t,e,0,r-1,i),null===this._root)this._root=v(t,e,0,r),this._size=r;else{var n=f(this.toList(),d(t,e),i);r=this._size+r,this._root=p({head:n},0,r)}return this},t.prototype.isEmpty=function(){return null===this._root},Object.defineProperty(t.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),t.prototype.toString=function(t){void 0===t&&(t=function(t){return String(t.key)});var e=[];return h(this._root,"",!0,(function(t){return e.push(t)}),t),e.join("")},t.prototype.update=function(t,e,a){var r=this._comparator,i=l(t,this._root,r),n=i.left,s=i.right;r(t,e)<0?s=o(e,a,s,r):n=o(e,a,n,r),this._root=u(n,s,r)},t.prototype.split=function(t){return l(t,this._root,this._comparator)},t}();function v(t,e,a,r){var n=r-a;if(n>0){var s=a+Math.floor(n/2),o=t[s],l=e[s],u=new i(o,l);return u.left=v(t,e,a,s),u.right=v(t,e,s+1,r),u}return null}function d(t,e){for(var a=new i(null,null),r=a,n=0;n<t.length;n++)r=r.next=new i(t[n],e[n]);return r.next=null,a.next}function m(t){var e=t,a=[],r=!1,n=new i(null,null),s=n;while(!r)e?(a.push(e),e=e.left):a.length>0?(e=s=s.next=a.pop(),e=e.right):r=!0;return s.next=null,n.next}function p(t,e,a){var r=a-e;if(r>0){var i=e+Math.floor(r/2),n=p(t,e,i),s=t.head;return s.left=n,t.head=t.head.next,s.right=p(t,i+1,a),s}return null}function f(t,e,a){var r=new i(null,null),n=r,s=t,o=e;while(null!==s&&null!==o)a(s.key,o.key)<0?(n.next=s,s=s.next):(n.next=o,o=o.next),n=n.next;return null!==s?n.next=s:null!==o&&(n.next=o),r.next}function g(t,e,a,r,i){if(!(a>=r)){var n=t[a+r>>1],s=a-1,o=r+1;while(1){do{s++}while(i(t[s],n)<0);do{o--}while(i(t[o],n)>0);if(s>=o)break;var l=t[s];t[s]=t[o],t[o]=l,l=e[s],e[s]=e[o],e[o]=l}g(t,e,a,o,i),g(t,e,o+1,r,i)}}var y=function(t,e){return t.ll.x<=e.x&&e.x<=t.ur.x&&t.ll.y<=e.y&&e.y<=t.ur.y},w=function(t,e){if(e.ur.x<t.ll.x||t.ur.x<e.ll.x||e.ur.y<t.ll.y||t.ur.y<e.ll.y)return null;var a=t.ll.x<e.ll.x?e.ll.x:t.ll.x,r=t.ur.x<e.ur.x?t.ur.x:e.ur.x,i=t.ll.y<e.ll.y?e.ll.y:t.ll.y,n=t.ur.y<e.ur.y?t.ur.y:e.ur.y;return{ll:{x:a,y:i},ur:{x:r,y:n}}},_=Number.EPSILON;void 0===_&&(_=Math.pow(2,-52));var b=_*_,x=function(t,e){if(-_<t&&t<_&&-_<e&&e<_)return 0;var a=t-e;return a*a<b*t*e?0:t<e?-1:1},E=function(){function e(){t(this,e),this.reset()}return r(e,[{key:"reset",value:function(){this.xRounder=new S,this.yRounder=new S}},{key:"round",value:function(t,e){return{x:this.xRounder.round(t),y:this.yRounder.round(e)}}}]),e}(),S=function(){function e(){t(this,e),this.tree=new c,this.round(0)}return r(e,[{key:"round",value:function(t){var e=this.tree.add(t),a=this.tree.prev(e);if(null!==a&&0===x(e.key,a.key))return this.tree.remove(t),a.key;var r=this.tree.next(e);return null!==r&&0===x(e.key,r.key)?(this.tree.remove(t),r.key):t}}]),e}(),k=new E,C=function(t,e){return t.x*e.y-t.y*e.x},M=function(t,e){return t.x*e.x+t.y*e.y},L=function(t,e,a){var r={x:e.x-t.x,y:e.y-t.y},i={x:a.x-t.x,y:a.y-t.y},n=C(r,i);return x(n,0)},N=function(t){return Math.sqrt(M(t,t))},P=function(t,e,a){var r={x:e.x-t.x,y:e.y-t.y},i={x:a.x-t.x,y:a.y-t.y};return C(i,r)/N(i)/N(r)},F=function(t,e,a){var r={x:e.x-t.x,y:e.y-t.y},i={x:a.x-t.x,y:a.y-t.y};return M(i,r)/N(i)/N(r)},D=function(t,e,a){return 0===e.y?null:{x:t.x+e.x/e.y*(a-t.y),y:a}},I=function(t,e,a){return 0===e.x?null:{x:a,y:t.y+e.y/e.x*(a-t.x)}},O=function(t,e,a,r){if(0===e.x)return I(a,r,t.x);if(0===r.x)return I(t,e,a.x);if(0===e.y)return D(a,r,t.y);if(0===r.y)return D(t,e,a.y);var i=C(e,r);if(0==i)return null;var n={x:a.x-t.x,y:a.y-t.y},s=C(n,e)/i,o=C(n,r)/i,l=t.x+o*e.x,u=a.x+s*r.x,h=t.y+o*e.y,c=a.y+s*r.y,v=(l+u)/2,d=(h+c)/2;return{x:v,y:d}},$=function(){function e(a,r){t(this,e),void 0===a.events?a.events=[this]:a.events.push(this),this.point=a,this.isLeft=r}return r(e,null,[{key:"compare",value:function(t,a){var r=e.comparePoints(t.point,a.point);return 0!==r?r:(t.point!==a.point&&t.link(a),t.isLeft!==a.isLeft?t.isLeft?1:-1:R.compare(t.segment,a.segment))}},{key:"comparePoints",value:function(t,e){return t.x<e.x?-1:t.x>e.x?1:t.y<e.y?-1:t.y>e.y?1:0}}]),r(e,[{key:"link",value:function(t){if(t.point===this.point)throw new Error("Tried to link already linked events");for(var e=t.point.events,a=0,r=e.length;a<r;a++){var i=e[a];this.point.events.push(i),i.point=this.point}this.checkForConsuming()}},{key:"checkForConsuming",value:function(){for(var t=this.point.events.length,e=0;e<t;e++){var a=this.point.events[e];if(void 0===a.segment.consumedBy)for(var r=e+1;r<t;r++){var i=this.point.events[r];void 0===i.consumedBy&&(a.otherSE.point.events===i.otherSE.point.events&&a.segment.consume(i.segment))}}}},{key:"getAvailableLinkedEvents",value:function(){for(var t=[],e=0,a=this.point.events.length;e<a;e++){var r=this.point.events[e];r!==this&&!r.segment.ringOut&&r.segment.isInResult()&&t.push(r)}return t}},{key:"getLeftmostComparator",value:function(t){var e=this,a=new Map,r=function(r){var i=r.otherSE;a.set(r,{sine:P(e.point,t.point,i.point),cosine:F(e.point,t.point,i.point)})};return function(t,e){a.has(t)||r(t),a.has(e)||r(e);var i=a.get(t),n=i.sine,s=i.cosine,o=a.get(e),l=o.sine,u=o.cosine;return n>=0&&l>=0?s<u?1:s>u?-1:0:n<0&&l<0?s<u?-1:s>u?1:0:l<n?-1:l>n?1:0}}}]),e}(),A=0,R=function(){function e(a,r,i,n){t(this,e),this.id=++A,this.leftSE=a,a.segment=this,a.otherSE=r,this.rightSE=r,r.segment=this,r.otherSE=a,this.rings=i,this.windings=n}return r(e,null,[{key:"compare",value:function(t,e){var a=t.leftSE.point.x,r=e.leftSE.point.x,i=t.rightSE.point.x,n=e.rightSE.point.x;if(n<a)return 1;if(i<r)return-1;var s=t.leftSE.point.y,o=e.leftSE.point.y,l=t.rightSE.point.y,u=e.rightSE.point.y;if(a<r){if(o<s&&o<l)return 1;if(o>s&&o>l)return-1;var h=t.comparePoint(e.leftSE.point);if(h<0)return 1;if(h>0)return-1;var c=e.comparePoint(t.rightSE.point);return 0!==c?c:-1}if(a>r){if(s<o&&s<u)return-1;if(s>o&&s>u)return 1;var v=e.comparePoint(t.leftSE.point);if(0!==v)return v;var d=t.comparePoint(e.rightSE.point);return d<0?1:d>0?-1:1}if(s<o)return-1;if(s>o)return 1;if(i<n){var m=e.comparePoint(t.rightSE.point);if(0!==m)return m}if(i>n){var p=t.comparePoint(e.rightSE.point);if(p<0)return 1;if(p>0)return-1}if(i!==n){var f=l-s,g=i-a,y=u-o,w=n-r;if(f>g&&y<w)return 1;if(f<g&&y>w)return-1}return i>n?1:i<n||l<u?-1:l>u?1:t.id<e.id?-1:t.id>e.id?1:0}}]),r(e,[{key:"replaceRightSE",value:function(t){this.rightSE=t,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}},{key:"bbox",value:function(){var t=this.leftSE.point.y,e=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:t<e?t:e},ur:{x:this.rightSE.point.x,y:t>e?t:e}}}},{key:"vector",value:function(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}},{key:"isAnEndpoint",value:function(t){return t.x===this.leftSE.point.x&&t.y===this.leftSE.point.y||t.x===this.rightSE.point.x&&t.y===this.rightSE.point.y}},{key:"comparePoint",value:function(t){if(this.isAnEndpoint(t))return 0;var e=this.leftSE.point,a=this.rightSE.point,r=this.vector();if(e.x===a.x)return t.x===e.x?0:t.x<e.x?1:-1;var i=(t.y-e.y)/r.y,n=e.x+i*r.x;if(t.x===n)return 0;var s=(t.x-e.x)/r.x,o=e.y+s*r.y;return t.y===o?0:t.y<o?-1:1}},{key:"getIntersection",value:function(t){var e=this.bbox(),a=t.bbox(),r=w(e,a);if(null===r)return null;var i=this.leftSE.point,n=this.rightSE.point,s=t.leftSE.point,o=t.rightSE.point,l=y(e,s)&&0===this.comparePoint(s),u=y(a,i)&&0===t.comparePoint(i),h=y(e,o)&&0===this.comparePoint(o),c=y(a,n)&&0===t.comparePoint(n);if(u&&l)return c&&!h?n:!c&&h?o:null;if(u)return h&&i.x===o.x&&i.y===o.y?null:i;if(l)return c&&n.x===s.x&&n.y===s.y?null:s;if(c&&h)return null;if(c)return n;if(h)return o;var v=O(i,this.vector(),s,t.vector());return null===v?null:y(r,v)?k.round(v.x,v.y):null}},{key:"split",value:function(t){var a=[],r=void 0!==t.events,i=new $(t,!0),n=new $(t,!1),s=this.rightSE;this.replaceRightSE(n),a.push(n),a.push(i);var o=new e(i,s,this.rings.slice(),this.windings.slice());return $.comparePoints(o.leftSE.point,o.rightSE.point)>0&&o.swapEvents(),$.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),r&&(i.checkForConsuming(),n.checkForConsuming()),a}},{key:"swapEvents",value:function(){var t=this.rightSE;this.rightSE=this.leftSE,this.leftSE=t,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(var e=0,a=this.windings.length;e<a;e++)this.windings[e]*=-1}},{key:"consume",value:function(t){var a=this,r=t;while(a.consumedBy)a=a.consumedBy;while(r.consumedBy)r=r.consumedBy;var i=e.compare(a,r);if(0!==i){if(i>0){var n=a;a=r,r=n}if(a.prev===r){var s=a;a=r,r=s}for(var o=0,l=r.rings.length;o<l;o++){var u=r.rings[o],h=r.windings[o],c=a.rings.indexOf(u);-1===c?(a.rings.push(u),a.windings.push(h)):a.windings[c]+=h}r.rings=null,r.windings=null,r.consumedBy=a,r.leftSE.consumedBy=a.leftSE,r.rightSE.consumedBy=a.rightSE}}},{key:"prevInResult",value:function(){return void 0!==this._prevInResult||(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null),this._prevInResult}},{key:"beforeState",value:function(){if(void 0!==this._beforeState)return this._beforeState;if(this.prev){var t=this.prev.consumedBy||this.prev;this._beforeState=t.afterState()}else this._beforeState={rings:[],windings:[],multiPolys:[]};return this._beforeState}},{key:"afterState",value:function(){if(void 0!==this._afterState)return this._afterState;var t=this.beforeState();this._afterState={rings:t.rings.slice(0),windings:t.windings.slice(0),multiPolys:[]};for(var e=this._afterState.rings,a=this._afterState.windings,r=this._afterState.multiPolys,i=0,n=this.rings.length;i<n;i++){var s=this.rings[i],o=this.windings[i],l=e.indexOf(s);-1===l?(e.push(s),a.push(o)):a[l]+=o}for(var u=[],h=[],c=0,v=e.length;c<v;c++)if(0!==a[c]){var d=e[c],m=d.poly;if(-1===h.indexOf(m))if(d.isExterior)u.push(m);else{-1===h.indexOf(m)&&h.push(m);var p=u.indexOf(d.poly);-1!==p&&u.splice(p,1)}}for(var f=0,g=u.length;f<g;f++){var y=u[f].multiPoly;-1===r.indexOf(y)&&r.push(y)}return this._afterState}},{key:"isInResult",value:function(){if(this.consumedBy)return!1;if(void 0!==this._isInResult)return this._isInResult;var t=this.beforeState().multiPolys,e=this.afterState().multiPolys;switch(W.type){case"union":var a=0===t.length,r=0===e.length;this._isInResult=a!==r;break;case"intersection":var i,n;t.length<e.length?(i=t.length,n=e.length):(i=e.length,n=t.length),this._isInResult=n===W.numMultiPolys&&i<n;break;case"xor":var s=Math.abs(t.length-e.length);this._isInResult=s%2===1;break;case"difference":var o=function(t){return 1===t.length&&t[0].isSubject};this._isInResult=o(t)!==o(e);break;default:throw new Error("Unrecognized operation type found ".concat(W.type))}return this._isInResult}}],[{key:"fromRing",value:function(t,a,r){var i,n,s,o=$.comparePoints(t,a);if(o<0)i=t,n=a,s=1;else{if(!(o>0))throw new Error("Tried to create degenerate segment at [".concat(t.x,", ").concat(t.y,"]"));i=a,n=t,s=-1}var l=new $(i,!0),u=new $(n,!1);return new e(l,u,[r],[s])}}]),e}(),T=function(){function e(a,r,i){if(t(this,e),!Array.isArray(a)||0===a.length)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=r,this.isExterior=i,this.segments=[],"number"!==typeof a[0][0]||"number"!==typeof a[0][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var n=k.round(a[0][0],a[0][1]);this.bbox={ll:{x:n.x,y:n.y},ur:{x:n.x,y:n.y}};for(var s=n,o=1,l=a.length;o<l;o++){if("number"!==typeof a[o][0]||"number"!==typeof a[o][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var u=k.round(a[o][0],a[o][1]);u.x===s.x&&u.y===s.y||(this.segments.push(R.fromRing(s,u,this)),u.x<this.bbox.ll.x&&(this.bbox.ll.x=u.x),u.y<this.bbox.ll.y&&(this.bbox.ll.y=u.y),u.x>this.bbox.ur.x&&(this.bbox.ur.x=u.x),u.y>this.bbox.ur.y&&(this.bbox.ur.y=u.y),s=u)}n.x===s.x&&n.y===s.y||this.segments.push(R.fromRing(s,n,this))}return r(e,[{key:"getSweepEvents",value:function(){for(var t=[],e=0,a=this.segments.length;e<a;e++){var r=this.segments[e];t.push(r.leftSE),t.push(r.rightSE)}return t}}]),e}(),B=function(){function e(a,r){if(t(this,e),!Array.isArray(a))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new T(a[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(var i=1,n=a.length;i<n;i++){var s=new T(a[i],this,!1);s.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=s.bbox.ll.x),s.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=s.bbox.ll.y),s.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=s.bbox.ur.x),s.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=s.bbox.ur.y),this.interiorRings.push(s)}this.multiPoly=r}return r(e,[{key:"getSweepEvents",value:function(){for(var t=this.exteriorRing.getSweepEvents(),e=0,a=this.interiorRings.length;e<a;e++)for(var r=this.interiorRings[e].getSweepEvents(),i=0,n=r.length;i<n;i++)t.push(r[i]);return t}}]),e}(),z=function(){function e(a,r){if(t(this,e),!Array.isArray(a))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{"number"===typeof a[0][0][0]&&(a=[a])}catch(o){}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(var i=0,n=a.length;i<n;i++){var s=new B(a[i],this);s.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=s.bbox.ll.x),s.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=s.bbox.ll.y),s.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=s.bbox.ur.x),s.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=s.bbox.ur.y),this.polys.push(s)}this.isSubject=r}return r(e,[{key:"getSweepEvents",value:function(){for(var t=[],e=0,a=this.polys.length;e<a;e++)for(var r=this.polys[e].getSweepEvents(),i=0,n=r.length;i<n;i++)t.push(r[i]);return t}}]),e}(),G=function(){function e(a){t(this,e),this.events=a;for(var r=0,i=a.length;r<i;r++)a[r].segment.ringOut=this;this.poly=null}return r(e,null,[{key:"factory",value:function(t){for(var a=[],r=0,i=t.length;r<i;r++){var n=t[r];if(n.isInResult()&&!n.ringOut){var s=null,o=n.leftSE,l=n.rightSE,u=[o],h=o.point,c=[];while(1){if(s=o,o=l,u.push(o),o.point===h)break;while(1){var v=o.getAvailableLinkedEvents();if(0===v.length){var d=u[0].point,m=u[u.length-1].point;throw new Error("Unable to complete output ring starting at [".concat(d.x,",")+" ".concat(d.y,"]. Last matching segment found ends at")+" [".concat(m.x,", ").concat(m.y,"]."))}if(1===v.length){l=v[0].otherSE;break}for(var p=null,f=0,g=c.length;f<g;f++)if(c[f].point===o.point){p=f;break}if(null===p){c.push({index:u.length,point:o.point});var y=o.getLeftmostComparator(s);l=v.sort(y)[0].otherSE;break}var w=c.splice(p)[0],_=u.splice(w.index);_.unshift(_[0].otherSE),a.push(new e(_.reverse()))}}a.push(new e(u))}}return a}}]),r(e,[{key:"getGeom",value:function(){for(var t=this.events[0].point,e=[t],a=1,r=this.events.length-1;a<r;a++){var i=this.events[a].point,n=this.events[a+1].point;0!==L(i,t,n)&&(e.push(i),t=i)}if(1===e.length)return null;var s=e[0],o=e[1];0===L(s,t,o)&&e.shift(),e.push(e[0]);for(var l=this.isExteriorRing()?1:-1,u=this.isExteriorRing()?0:e.length-1,h=this.isExteriorRing()?e.length:-1,c=[],v=u;v!=h;v+=l)c.push([e[v].x,e[v].y]);return c}},{key:"isExteriorRing",value:function(){if(void 0===this._isExteriorRing){var t=this.enclosingRing();this._isExteriorRing=!t||!t.isExteriorRing()}return this._isExteriorRing}},{key:"enclosingRing",value:function(){return void 0===this._enclosingRing&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}},{key:"_calcEnclosingRing",value:function(){for(var t=this.events[0],e=1,a=this.events.length;e<a;e++){var r=this.events[e];$.compare(t,r)>0&&(t=r)}var i=t.segment.prevInResult(),n=i?i.prevInResult():null;while(1){if(!i)return null;if(!n)return i.ringOut;if(n.ringOut!==i.ringOut)return n.ringOut.enclosingRing()!==i.ringOut?i.ringOut:i.ringOut.enclosingRing();i=n.prevInResult(),n=i?i.prevInResult():null}}}]),e}(),j=function(){function e(a){t(this,e),this.exteriorRing=a,a.poly=this,this.interiorRings=[]}return r(e,[{key:"addInterior",value:function(t){this.interiorRings.push(t),t.poly=this}},{key:"getGeom",value:function(){var t=[this.exteriorRing.getGeom()];if(null===t[0])return null;for(var e=0,a=this.interiorRings.length;e<a;e++){var r=this.interiorRings[e].getGeom();null!==r&&t.push(r)}return t}}]),e}(),V=function(){function e(a){t(this,e),this.rings=a,this.polys=this._composePolys(a)}return r(e,[{key:"getGeom",value:function(){for(var t=[],e=0,a=this.polys.length;e<a;e++){var r=this.polys[e].getGeom();null!==r&&t.push(r)}return t}},{key:"_composePolys",value:function(t){for(var e=[],a=0,r=t.length;a<r;a++){var i=t[a];if(!i.poly)if(i.isExteriorRing())e.push(new j(i));else{var n=i.enclosingRing();n.poly||e.push(new j(n)),n.poly.addInterior(i)}}return e}}]),e}(),Z=function(){function e(a){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:R.compare;t(this,e),this.queue=a,this.tree=new c(r),this.segments=[]}return r(e,[{key:"process",value:function(t){var e=t.segment,a=[];if(t.consumedBy)return t.isLeft?this.queue.remove(t.otherSE):this.tree.remove(e),a;var r=t.isLeft?this.tree.insert(e):this.tree.find(e);if(!r)throw new Error("Unable to find segment #".concat(e.id," ")+"[".concat(e.leftSE.point.x,", ").concat(e.leftSE.point.y,"] -> ")+"[".concat(e.rightSE.point.x,", ").concat(e.rightSE.point.y,"] ")+"in SweepLine tree. Please submit a bug report.");var i=r,n=r,s=void 0,o=void 0;while(void 0===s)i=this.tree.prev(i),null===i?s=null:void 0===i.key.consumedBy&&(s=i.key);while(void 0===o)n=this.tree.next(n),null===n?o=null:void 0===n.key.consumedBy&&(o=n.key);if(t.isLeft){var l=null;if(s){var u=s.getIntersection(e);if(null!==u&&(e.isAnEndpoint(u)||(l=u),!s.isAnEndpoint(u)))for(var h=this._splitSafely(s,u),c=0,v=h.length;c<v;c++)a.push(h[c])}var d=null;if(o){var m=o.getIntersection(e);if(null!==m&&(e.isAnEndpoint(m)||(d=m),!o.isAnEndpoint(m)))for(var p=this._splitSafely(o,m),f=0,g=p.length;f<g;f++)a.push(p[f])}if(null!==l||null!==d){var y=null;if(null===l)y=d;else if(null===d)y=l;else{var w=$.comparePoints(l,d);y=w<=0?l:d}this.queue.remove(e.rightSE),a.push(e.rightSE);for(var _=e.split(y),b=0,x=_.length;b<x;b++)a.push(_[b])}a.length>0?(this.tree.remove(e),a.push(t)):(this.segments.push(e),e.prev=s)}else{if(s&&o){var E=s.getIntersection(o);if(null!==E){if(!s.isAnEndpoint(E))for(var S=this._splitSafely(s,E),k=0,C=S.length;k<C;k++)a.push(S[k]);if(!o.isAnEndpoint(E))for(var M=this._splitSafely(o,E),L=0,N=M.length;L<N;L++)a.push(M[L])}}this.tree.remove(e)}return a}},{key:"_splitSafely",value:function(t,e){this.tree.remove(t);var a=t.rightSE;this.queue.remove(a);var r=t.split(e);return r.push(a),void 0===t.consumedBy&&this.tree.insert(t),r}}]),e}(),q="undefined"!==typeof e&&Object({NODE_ENV:"production",BASE_URL:"/c2c_ui/yeti-add-bra/"}).POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,U="undefined"!==typeof e&&Object({NODE_ENV:"production",BASE_URL:"/c2c_ui/yeti-add-bra/"}).POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6,Y=function(){function e(){t(this,e)}return r(e,[{key:"run",value:function(t,e,a){W.type=t,k.reset();for(var r=[new z(e,!0)],i=0,n=a.length;i<n;i++)r.push(new z(a[i],!1));if(W.numMultiPolys=r.length,"difference"===W.type){var s=r[0],o=1;while(o<r.length)null!==w(r[o].bbox,s.bbox)?o++:r.splice(o,1)}if("intersection"===W.type)for(var l=0,u=r.length;l<u;l++)for(var h=r[l],v=l+1,d=r.length;v<d;v++)if(null===w(h.bbox,r[v].bbox))return[];for(var m=new c($.compare),p=0,f=r.length;p<f;p++)for(var g=r[p].getSweepEvents(),y=0,_=g.length;y<_;y++)if(m.insert(g[y]),m.size>q)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big). Please file a bug report.");var b=new Z(m),x=m.size,E=m.pop();while(E){var S=E.key;if(m.size===x){var C=S.segment;throw new Error("Unable to pop() ".concat(S.isLeft?"left":"right"," SweepEvent ")+"[".concat(S.point.x,", ").concat(S.point.y,"] from segment #").concat(C.id," ")+"[".concat(C.leftSE.point.x,", ").concat(C.leftSE.point.y,"] -> ")+"[".concat(C.rightSE.point.x,", ").concat(C.rightSE.point.y,"] from queue. ")+"Please file a bug report.")}if(m.size>q)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big). Please file a bug report.");if(b.segments.length>U)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments). Please file a bug report.");for(var M=b.process(S),L=0,N=M.length;L<N;L++){var P=M[L];void 0===P.consumedBy&&m.insert(P)}x=m.size,E=m.pop()}k.reset();var F=G.factory(b.segments),D=new V(F);return D.getGeom()}}]),e}(),W=new Y,K=function(t){for(var e=arguments.length,a=new Array(e>1?e-1:0),r=1;r<e;r++)a[r-1]=arguments[r];return W.run("union",t,a)},J=function(t){for(var e=arguments.length,a=new Array(e>1?e-1:0),r=1;r<e;r++)a[r-1]=arguments[r];return W.run("intersection",t,a)},X=function(t){for(var e=arguments.length,a=new Array(e>1?e-1:0),r=1;r<e;r++)a[r-1]=arguments[r];return W.run("xor",t,a)},H=function(t){for(var e=arguments.length,a=new Array(e>1?e-1:0),r=1;r<e;r++)a[r-1]=arguments[r];return W.run("difference",t,a)},Q={union:K,intersection:J,xor:X,difference:H};return Q}))}).call(this,a("4362"))},dd90:function(t,e,a){},e004:function(t,e,a){t.exports=a.p+"img/logo-ensg.35fbf647.webp"},e375:function(t,e,a){"use strict";a("bd20")},e457:function(t,e,a){},e469:function(t,e,a){"use strict";a("9e38")},e7e3:function(t,e,a){"use strict";a("dd90")},efa0:function(t,e,a){"use strict";a("03a8")},fc52:function(t,e,a){t.exports=a.p+"img/logo-fondation-petzl.4b665657.jpg"}}]);
//# sourceMappingURL=yeti-legacy.e80c222d.js.map